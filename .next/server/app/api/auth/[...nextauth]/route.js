"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/[...nextauth]/route";
exports.ids = ["app/api/auth/[...nextauth]/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("querystring");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=C%3A%5Cmani%5Cise%5Cprojects%5CArbutus%5Capps%5Canalyzer-web%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cmani%5Cise%5Cprojects%5CArbutus%5Capps%5Canalyzer-web&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=C%3A%5Cmani%5Cise%5Cprojects%5CArbutus%5Capps%5Canalyzer-web%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cmani%5Cise%5Cprojects%5CArbutus%5Capps%5Canalyzer-web&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_mani_ise_projects_Arbutus_apps_analyzer_web_app_api_auth_nextauth_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/auth/[...nextauth]/route.ts */ \"(rsc)/./app/api/auth/[...nextauth]/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/[...nextauth]/route\",\n        pathname: \"/api/auth/[...nextauth]\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/[...nextauth]/route\"\n    },\n    resolvedPagePath: \"C:\\\\mani\\\\ise\\\\projects\\\\Arbutus\\\\apps\\\\analyzer-web\\\\app\\\\api\\\\auth\\\\[...nextauth]\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_mani_ise_projects_Arbutus_apps_analyzer_web_app_api_auth_nextauth_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/auth/[...nextauth]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGJTVCLi4ubmV4dGF1dGglNUQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkYlNUIuLi5uZXh0YXV0aCU1RCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkYlNUIuLi5uZXh0YXV0aCU1RCUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDbWFuaSU1Q2lzZSU1Q3Byb2plY3RzJTVDQXJidXR1cyU1Q2FwcHMlNUNhbmFseXplci13ZWIlNUNhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPUMlM0ElNUNtYW5pJTVDaXNlJTVDcHJvamVjdHMlNUNBcmJ1dHVzJTVDYXBwcyU1Q2FuYWx5emVyLXdlYiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUM2QztBQUMxSDtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL2FuYWx5emVyLXdlYi8/YTM5OCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxtYW5pXFxcXGlzZVxcXFxwcm9qZWN0c1xcXFxBcmJ1dHVzXFxcXGFwcHNcXFxcYW5hbHl6ZXItd2ViXFxcXGFwcFxcXFxhcGlcXFxcYXV0aFxcXFxbLi4ubmV4dGF1dGhdXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hdXRoL1suLi5uZXh0YXV0aF0vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hdXRoL1suLi5uZXh0YXV0aF1cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXG1hbmlcXFxcaXNlXFxcXHByb2plY3RzXFxcXEFyYnV0dXNcXFxcYXBwc1xcXFxhbmFseXplci13ZWJcXFxcYXBwXFxcXGFwaVxcXFxhdXRoXFxcXFsuLi5uZXh0YXV0aF1cXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0IH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvYXV0aC9bLi4ubmV4dGF1dGhdL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCwgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=C%3A%5Cmani%5Cise%5Cprojects%5CArbutus%5Capps%5Canalyzer-web%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cmani%5Cise%5Cprojects%5CArbutus%5Capps%5Canalyzer-web&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/auth/[...nextauth]/route.ts":
/*!*********************************************!*\
  !*** ./app/api/auth/[...nextauth]/route.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ handler),\n/* harmony export */   POST: () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/auth */ \"(rsc)/./lib/auth.ts\");\n\n\nconst handler = next_auth__WEBPACK_IMPORTED_MODULE_0___default()(_lib_auth__WEBPACK_IMPORTED_MODULE_1__.authOptions);\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFpQztBQUNRO0FBRXpDLE1BQU1FLFVBQVVGLGdEQUFRQSxDQUFDQyxrREFBV0E7QUFFTyIsInNvdXJjZXMiOlsid2VicGFjazovL2FuYWx5emVyLXdlYi8uL2FwcC9hcGkvYXV0aC9bLi4ubmV4dGF1dGhdL3JvdXRlLnRzP2M4YTQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE5leHRBdXRoIGZyb20gXCJuZXh0LWF1dGhcIjtcbmltcG9ydCB7IGF1dGhPcHRpb25zIH0gZnJvbSBcIkAvbGliL2F1dGhcIjtcblxuY29uc3QgaGFuZGxlciA9IE5leHRBdXRoKGF1dGhPcHRpb25zKTtcblxuZXhwb3J0IHsgaGFuZGxlciBhcyBHRVQsIGhhbmRsZXIgYXMgUE9TVCB9OyJdLCJuYW1lcyI6WyJOZXh0QXV0aCIsImF1dGhPcHRpb25zIiwiaGFuZGxlciIsIkdFVCIsIlBPU1QiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/[...nextauth]/route.ts\n");

/***/ }),

/***/ "(rsc)/./lib/auth.ts":
/*!*********************!*\
  !*** ./lib/auth.ts ***!
  \*********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   authOptions: () => (/* binding */ authOptions)\n/* harmony export */ });\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./lib/prisma.ts\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_constants__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/constants */ \"(rsc)/./lib/constants.ts\");\n/* harmony import */ var _services_UserService__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/services/UserService */ \"(rsc)/./services/UserService.ts\");\n/* harmony import */ var _services_AuditService__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/services/AuditService */ \"(rsc)/./services/AuditService.ts\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_6__);\n\n\n\n\n\n\n\n// Simple in-memory store for rate limiting (Note: In serverless, this resets, use Redis for prod)\nconst loginAttempts = {};\nconst authOptions = {\n    secret: process.env.NEXTAUTH_SECRET || \"analyzer-web-dev-secret-key-123\",\n    session: {\n        strategy: \"jwt\",\n        maxAge: 24 * 60 * 60,\n        updateAge: 60 * 60\n    },\n    pages: {\n        signIn: \"/login\"\n    },\n    providers: [\n        (0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({\n            name: \"Credentials\",\n            credentials: {\n                email: {\n                    label: \"Email\",\n                    type: \"email\"\n                },\n                password: {\n                    label: \"Password\",\n                    type: \"password\"\n                }\n            },\n            async authorize (credentials) {\n                if (!credentials?.email || !credentials?.password) {\n                    return null;\n                }\n                const email = credentials.email.toLowerCase();\n                // Check Lockout\n                const attempt = loginAttempts[email];\n                if (attempt && attempt.lockUntil > Date.now()) {\n                    throw new Error(`Account locked. Try again in ${Math.ceil((attempt.lockUntil - Date.now()) / 60000)} minutes.`);\n                }\n                try {\n                    // 1. Find user in database\n                    const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.user.findUnique({\n                        where: {\n                            email\n                        }\n                    });\n                    if (user) {\n                        // Check user status\n                        if (user.status === \"locked\") {\n                            // Check if lock has expired\n                            if (user.lockedUntil && user.lockedUntil > new Date()) {\n                                throw new Error(`Account is locked until ${user.lockedUntil.toLocaleString()}.`);\n                            } else if (user.lockedUntil && user.lockedUntil <= new Date()) {\n                                // Unlock account if lock period expired\n                                await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.user.update({\n                                    where: {\n                                        id: user.id\n                                    },\n                                    data: {\n                                        status: \"active\",\n                                        lockedUntil: null,\n                                        failedLoginAttempts: 0\n                                    }\n                                });\n                            }\n                        }\n                        if (user.status === \"inactive\") {\n                            throw new Error(\"Account is inactive. Please contact administrator.\");\n                        }\n                        const isPasswordValid = await (0,bcryptjs__WEBPACK_IMPORTED_MODULE_2__.compare)(credentials.password, user.password);\n                        if (!isPasswordValid) {\n                            // Record failed attempt in database\n                            const failedAttempts = await _services_UserService__WEBPACK_IMPORTED_MODULE_4__.userService.incrementFailedLogins(user.id);\n                            // Lock account if max attempts reached\n                            if (failedAttempts >= _lib_constants__WEBPACK_IMPORTED_MODULE_3__.MAX_LOGIN_ATTEMPTS) {\n                                const lockUntil = new Date(Date.now() + _lib_constants__WEBPACK_IMPORTED_MODULE_3__.LOCKOUT_TIME_MS);\n                                await _services_UserService__WEBPACK_IMPORTED_MODULE_4__.userService.lockUser(user.id, lockUntil);\n                                // Log failed login with lockout\n                                await _services_AuditService__WEBPACK_IMPORTED_MODULE_5__.auditService.createAuditLog({\n                                    userId: user.id,\n                                    actionType: \"LOGIN\",\n                                    entityType: \"USER\",\n                                    entityId: user.id,\n                                    changeSummary: `Failed login attempt - Account locked until ${lockUntil.toLocaleString()}`,\n                                    ipAddress: \"Unknown\"\n                                });\n                                throw new Error(`Too many failed attempts. Account locked until ${lockUntil.toLocaleString()}.`);\n                            }\n                            // Log failed attempt\n                            await _services_AuditService__WEBPACK_IMPORTED_MODULE_5__.auditService.createAuditLog({\n                                userId: user.id,\n                                actionType: \"LOGIN\",\n                                entityType: \"USER\",\n                                entityId: user.id,\n                                changeSummary: `Failed login attempt (${failedAttempts}/${_lib_constants__WEBPACK_IMPORTED_MODULE_3__.MAX_LOGIN_ATTEMPTS})`\n                            });\n                            return null;\n                        }\n                        // Success - Update last login and reset failed attempts\n                        await _services_UserService__WEBPACK_IMPORTED_MODULE_4__.userService.updateLastLogin(user.id);\n                        // Create device session for tracking\n                        const sessionToken = crypto__WEBPACK_IMPORTED_MODULE_6___default().randomBytes(32).toString(\"hex\");\n                        const expiresAt = new Date(Date.now() + 24 * 60 * 60 * 1000); // 24 hours\n                        await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.deviceSession.create({\n                            data: {\n                                userId: user.id,\n                                device: \"Browser\",\n                                ip: \"Unknown\",\n                                token: sessionToken,\n                                expiresAt,\n                                isCurrent: true\n                            }\n                        });\n                        // Log successful login\n                        await _services_AuditService__WEBPACK_IMPORTED_MODULE_5__.auditService.createAuditLog({\n                            userId: user.id,\n                            actionType: \"LOGIN\",\n                            entityType: \"USER\",\n                            entityId: user.id,\n                            changeSummary: \"Successful login\",\n                            sessionId: sessionToken\n                        });\n                        return {\n                            id: user.id,\n                            email: user.email,\n                            name: user.name,\n                            role: user.role,\n                            avatar: user.avatar || \"U\",\n                            image: user.avatar,\n                            sessionToken\n                        };\n                    }\n                } catch (error) {\n                    // If the error message is one of our custom ones, rethrow it\n                    if (error.message.includes(\"Account is\") || error.message.includes(\"locked\") || error.message.includes(\"Too many\")) {\n                        throw error;\n                    }\n                    console.warn(\"Database auth error:\", error);\n                }\n                // Failed to find user or verify password\n                return null;\n            }\n        })\n    ],\n    callbacks: {\n        async session ({ session, token }) {\n            if (token && session.user) {\n                session.user.id = token.id;\n                session.user.name = token.name;\n                session.user.email = token.email;\n                session.user.role = token.role;\n                session.user.avatar = token.avatar;\n                session.user.sessionToken = token.sessionToken;\n            }\n            return session;\n        },\n        async jwt ({ token, user }) {\n            if (user) {\n                token.id = user.id;\n                token.name = user.name;\n                token.email = user.email;\n                token.role = user.role;\n                token.avatar = user.avatar;\n                token.sessionToken = user.sessionToken;\n            }\n            return token;\n        }\n    },\n    events: {\n        async signOut ({ token }) {\n            // Log logout event\n            if (token?.id) {\n                try {\n                    await _services_AuditService__WEBPACK_IMPORTED_MODULE_5__.auditService.createAuditLog({\n                        userId: token.id,\n                        actionType: \"LOGOUT\",\n                        entityType: \"USER\",\n                        entityId: token.id,\n                        changeSummary: \"User logged out\",\n                        sessionId: token.sessionToken\n                    });\n                    // Mark device session as inactive\n                    if (token.sessionToken) {\n                        await _lib_prisma__WEBPACK_IMPORTED_MODULE_1__.prisma.deviceSession.updateMany({\n                            where: {\n                                token: token.sessionToken\n                            },\n                            data: {\n                                isCurrent: false\n                            }\n                        });\n                    }\n                } catch (error) {\n                    console.error(\"Error logging signOut:\", error);\n                }\n            }\n        }\n    }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Il0sInNvdXJjZXNDb250ZW50IjpbIlxuXG5pbXBvcnQgeyBOZXh0QXV0aE9wdGlvbnMgfSBmcm9tIFwibmV4dC1hdXRoXCI7XG5pbXBvcnQgQ3JlZGVudGlhbHNQcm92aWRlciBmcm9tIFwibmV4dC1hdXRoL3Byb3ZpZGVycy9jcmVkZW50aWFsc1wiO1xuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSBcIkAvbGliL3ByaXNtYVwiO1xuaW1wb3J0IHsgY29tcGFyZSB9IGZyb20gXCJiY3J5cHRqc1wiO1xuaW1wb3J0IHsgTUFYX0xPR0lOX0FUVEVNUFRTLCBMT0NLT1VUX1RJTUVfTVMgfSBmcm9tIFwiQC9saWIvY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBVc2VyUm9sZSB9IGZyb20gXCJAL2xpYi90eXBlc1wiO1xuaW1wb3J0IHsgdXNlclNlcnZpY2UgfSBmcm9tIFwiQC9zZXJ2aWNlcy9Vc2VyU2VydmljZVwiO1xuaW1wb3J0IHsgYXVkaXRTZXJ2aWNlIH0gZnJvbSBcIkAvc2VydmljZXMvQXVkaXRTZXJ2aWNlXCI7XG5pbXBvcnQgY3J5cHRvIGZyb20gXCJjcnlwdG9cIjtcblxuLy8gU2ltcGxlIGluLW1lbW9yeSBzdG9yZSBmb3IgcmF0ZSBsaW1pdGluZyAoTm90ZTogSW4gc2VydmVybGVzcywgdGhpcyByZXNldHMsIHVzZSBSZWRpcyBmb3IgcHJvZClcbmNvbnN0IGxvZ2luQXR0ZW1wdHM6IFJlY29yZDxzdHJpbmcsIHsgY291bnQ6IG51bWJlciwgbG9ja1VudGlsOiBudW1iZXIgfT4gPSB7fTtcblxuZXhwb3J0IGNvbnN0IGF1dGhPcHRpb25zOiBOZXh0QXV0aE9wdGlvbnMgPSB7XG4gIHNlY3JldDogcHJvY2Vzcy5lbnYuTkVYVEFVVEhfU0VDUkVUIHx8IFwiYW5hbHl6ZXItd2ViLWRldi1zZWNyZXQta2V5LTEyM1wiLFxuICBzZXNzaW9uOiB7XG4gICAgc3RyYXRlZ3k6IFwiand0XCIsXG4gICAgbWF4QWdlOiAyNCAqIDYwICogNjAsIC8vIDI0IGhvdXJzXG4gICAgdXBkYXRlQWdlOiA2MCAqIDYwLCAvLyBVcGRhdGUgc2Vzc2lvbiBldmVyeSBob3VyXG4gIH0sXG4gIHBhZ2VzOiB7XG4gICAgc2lnbkluOiBcIi9sb2dpblwiLFxuICB9LFxuICBwcm92aWRlcnM6IFtcbiAgICBDcmVkZW50aWFsc1Byb3ZpZGVyKHtcbiAgICAgIG5hbWU6IFwiQ3JlZGVudGlhbHNcIixcbiAgICAgIGNyZWRlbnRpYWxzOiB7XG4gICAgICAgIGVtYWlsOiB7IGxhYmVsOiBcIkVtYWlsXCIsIHR5cGU6IFwiZW1haWxcIiB9LFxuICAgICAgICBwYXNzd29yZDogeyBsYWJlbDogXCJQYXNzd29yZFwiLCB0eXBlOiBcInBhc3N3b3JkXCIgfVxuICAgICAgfSxcbiAgICAgIGFzeW5jIGF1dGhvcml6ZShjcmVkZW50aWFscykge1xuICAgICAgICBpZiAoIWNyZWRlbnRpYWxzPy5lbWFpbCB8fCAhY3JlZGVudGlhbHM/LnBhc3N3b3JkKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBlbWFpbCA9IGNyZWRlbnRpYWxzLmVtYWlsLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgLy8gQ2hlY2sgTG9ja291dFxuICAgICAgICBjb25zdCBhdHRlbXB0ID0gbG9naW5BdHRlbXB0c1tlbWFpbF07XG4gICAgICAgIGlmIChhdHRlbXB0ICYmIGF0dGVtcHQubG9ja1VudGlsID4gRGF0ZS5ub3coKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBBY2NvdW50IGxvY2tlZC4gVHJ5IGFnYWluIGluICR7TWF0aC5jZWlsKChhdHRlbXB0LmxvY2tVbnRpbCAtIERhdGUubm93KCkpIC8gNjAwMDApfSBtaW51dGVzLmApO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvLyAxLiBGaW5kIHVzZXIgaW4gZGF0YWJhc2VcbiAgICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICAgICAgICB3aGVyZTogeyBlbWFpbCB9XG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICBpZiAodXNlcikge1xuICAgICAgICAgICAgLy8gQ2hlY2sgdXNlciBzdGF0dXNcbiAgICAgICAgICAgIGlmICh1c2VyLnN0YXR1cyA9PT0gJ2xvY2tlZCcpIHtcbiAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgbG9jayBoYXMgZXhwaXJlZFxuICAgICAgICAgICAgICBpZiAodXNlci5sb2NrZWRVbnRpbCAmJiB1c2VyLmxvY2tlZFVudGlsID4gbmV3IERhdGUoKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQWNjb3VudCBpcyBsb2NrZWQgdW50aWwgJHt1c2VyLmxvY2tlZFVudGlsLnRvTG9jYWxlU3RyaW5nKCl9LmApO1xuICAgICAgICAgICAgICB9IGVsc2UgaWYgKHVzZXIubG9ja2VkVW50aWwgJiYgdXNlci5sb2NrZWRVbnRpbCA8PSBuZXcgRGF0ZSgpKSB7XG4gICAgICAgICAgICAgICAgLy8gVW5sb2NrIGFjY291bnQgaWYgbG9jayBwZXJpb2QgZXhwaXJlZFxuICAgICAgICAgICAgICAgIGF3YWl0IHByaXNtYS51c2VyLnVwZGF0ZSh7XG4gICAgICAgICAgICAgICAgICB3aGVyZTogeyBpZDogdXNlci5pZCB9LFxuICAgICAgICAgICAgICAgICAgZGF0YTogeyBzdGF0dXM6ICdhY3RpdmUnLCBsb2NrZWRVbnRpbDogbnVsbCwgZmFpbGVkTG9naW5BdHRlbXB0czogMCB9LFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICh1c2VyLnN0YXR1cyA9PT0gJ2luYWN0aXZlJykge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJBY2NvdW50IGlzIGluYWN0aXZlLiBQbGVhc2UgY29udGFjdCBhZG1pbmlzdHJhdG9yLlwiKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgaXNQYXNzd29yZFZhbGlkID0gYXdhaXQgY29tcGFyZShjcmVkZW50aWFscy5wYXNzd29yZCwgdXNlci5wYXNzd29yZCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICghaXNQYXNzd29yZFZhbGlkKSB7XG4gICAgICAgICAgICAgIC8vIFJlY29yZCBmYWlsZWQgYXR0ZW1wdCBpbiBkYXRhYmFzZVxuICAgICAgICAgICAgICBjb25zdCBmYWlsZWRBdHRlbXB0cyA9IGF3YWl0IHVzZXJTZXJ2aWNlLmluY3JlbWVudEZhaWxlZExvZ2lucyh1c2VyLmlkKTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIC8vIExvY2sgYWNjb3VudCBpZiBtYXggYXR0ZW1wdHMgcmVhY2hlZFxuICAgICAgICAgICAgICBpZiAoZmFpbGVkQXR0ZW1wdHMgPj0gTUFYX0xPR0lOX0FUVEVNUFRTKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbG9ja1VudGlsID0gbmV3IERhdGUoRGF0ZS5ub3coKSArIExPQ0tPVVRfVElNRV9NUyk7XG4gICAgICAgICAgICAgICAgYXdhaXQgdXNlclNlcnZpY2UubG9ja1VzZXIodXNlci5pZCwgbG9ja1VudGlsKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBMb2cgZmFpbGVkIGxvZ2luIHdpdGggbG9ja291dFxuICAgICAgICAgICAgICAgIGF3YWl0IGF1ZGl0U2VydmljZS5jcmVhdGVBdWRpdExvZyh7XG4gICAgICAgICAgICAgICAgICB1c2VySWQ6IHVzZXIuaWQsXG4gICAgICAgICAgICAgICAgICBhY3Rpb25UeXBlOiAnTE9HSU4nLFxuICAgICAgICAgICAgICAgICAgZW50aXR5VHlwZTogJ1VTRVInLFxuICAgICAgICAgICAgICAgICAgZW50aXR5SWQ6IHVzZXIuaWQsXG4gICAgICAgICAgICAgICAgICBjaGFuZ2VTdW1tYXJ5OiBgRmFpbGVkIGxvZ2luIGF0dGVtcHQgLSBBY2NvdW50IGxvY2tlZCB1bnRpbCAke2xvY2tVbnRpbC50b0xvY2FsZVN0cmluZygpfWAsXG4gICAgICAgICAgICAgICAgICBpcEFkZHJlc3M6ICdVbmtub3duJywgLy8gV2lsbCBiZSBhZGRlZCB2aWEgbWlkZGxld2FyZSBpbiBQaGFzZSAxLjRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRvbyBtYW55IGZhaWxlZCBhdHRlbXB0cy4gQWNjb3VudCBsb2NrZWQgdW50aWwgJHtsb2NrVW50aWwudG9Mb2NhbGVTdHJpbmcoKX0uYCk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIC8vIExvZyBmYWlsZWQgYXR0ZW1wdFxuICAgICAgICAgICAgICBhd2FpdCBhdWRpdFNlcnZpY2UuY3JlYXRlQXVkaXRMb2coe1xuICAgICAgICAgICAgICAgIHVzZXJJZDogdXNlci5pZCxcbiAgICAgICAgICAgICAgICBhY3Rpb25UeXBlOiAnTE9HSU4nLFxuICAgICAgICAgICAgICAgIGVudGl0eVR5cGU6ICdVU0VSJyxcbiAgICAgICAgICAgICAgICBlbnRpdHlJZDogdXNlci5pZCxcbiAgICAgICAgICAgICAgICBjaGFuZ2VTdW1tYXJ5OiBgRmFpbGVkIGxvZ2luIGF0dGVtcHQgKCR7ZmFpbGVkQXR0ZW1wdHN9LyR7TUFYX0xPR0lOX0FUVEVNUFRTfSlgLFxuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBTdWNjZXNzIC0gVXBkYXRlIGxhc3QgbG9naW4gYW5kIHJlc2V0IGZhaWxlZCBhdHRlbXB0c1xuICAgICAgICAgICAgYXdhaXQgdXNlclNlcnZpY2UudXBkYXRlTGFzdExvZ2luKHVzZXIuaWQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDcmVhdGUgZGV2aWNlIHNlc3Npb24gZm9yIHRyYWNraW5nXG4gICAgICAgICAgICBjb25zdCBzZXNzaW9uVG9rZW4gPSBjcnlwdG8ucmFuZG9tQnl0ZXMoMzIpLnRvU3RyaW5nKCdoZXgnKTtcbiAgICAgICAgICAgIGNvbnN0IGV4cGlyZXNBdCA9IG5ldyBEYXRlKERhdGUubm93KCkgKyAyNCAqIDYwICogNjAgKiAxMDAwKTsgLy8gMjQgaG91cnNcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgYXdhaXQgcHJpc21hLmRldmljZVNlc3Npb24uY3JlYXRlKHtcbiAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIHVzZXJJZDogdXNlci5pZCxcbiAgICAgICAgICAgICAgICBkZXZpY2U6ICdCcm93c2VyJywgLy8gV2lsbCBiZSBlbmhhbmNlZCB3aXRoIHVzZXIgYWdlbnQgcGFyc2luZ1xuICAgICAgICAgICAgICAgIGlwOiAnVW5rbm93bicsIC8vIFdpbGwgYmUgYWRkZWQgdmlhIG1pZGRsZXdhcmVcbiAgICAgICAgICAgICAgICB0b2tlbjogc2Vzc2lvblRva2VuLFxuICAgICAgICAgICAgICAgIGV4cGlyZXNBdCxcbiAgICAgICAgICAgICAgICBpc0N1cnJlbnQ6IHRydWUsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gTG9nIHN1Y2Nlc3NmdWwgbG9naW5cbiAgICAgICAgICAgIGF3YWl0IGF1ZGl0U2VydmljZS5jcmVhdGVBdWRpdExvZyh7XG4gICAgICAgICAgICAgIHVzZXJJZDogdXNlci5pZCxcbiAgICAgICAgICAgICAgYWN0aW9uVHlwZTogJ0xPR0lOJyxcbiAgICAgICAgICAgICAgZW50aXR5VHlwZTogJ1VTRVInLFxuICAgICAgICAgICAgICBlbnRpdHlJZDogdXNlci5pZCxcbiAgICAgICAgICAgICAgY2hhbmdlU3VtbWFyeTogJ1N1Y2Nlc3NmdWwgbG9naW4nLFxuICAgICAgICAgICAgICBzZXNzaW9uSWQ6IHNlc3Npb25Ub2tlbixcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICBpZDogdXNlci5pZCxcbiAgICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgICAgIG5hbWU6IHVzZXIubmFtZSxcbiAgICAgICAgICAgICAgcm9sZTogdXNlci5yb2xlIGFzIFVzZXJSb2xlLFxuICAgICAgICAgICAgICBhdmF0YXI6IHVzZXIuYXZhdGFyIHx8ICdVJyxcbiAgICAgICAgICAgICAgaW1hZ2U6IHVzZXIuYXZhdGFyLFxuICAgICAgICAgICAgICBzZXNzaW9uVG9rZW4sIC8vIFBhc3Mgc2Vzc2lvbiB0b2tlbiBmb3IgdHJhY2tpbmdcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAgICAgLy8gSWYgdGhlIGVycm9yIG1lc3NhZ2UgaXMgb25lIG9mIG91ciBjdXN0b20gb25lcywgcmV0aHJvdyBpdFxuICAgICAgICAgIGlmIChlcnJvci5tZXNzYWdlLmluY2x1ZGVzKFwiQWNjb3VudCBpc1wiKSB8fCBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKFwibG9ja2VkXCIpIHx8IGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoXCJUb28gbWFueVwiKSkge1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnNvbGUud2FybihcIkRhdGFiYXNlIGF1dGggZXJyb3I6XCIsIGVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEZhaWxlZCB0byBmaW5kIHVzZXIgb3IgdmVyaWZ5IHBhc3N3b3JkXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH0pXG4gIF0sXG4gIGNhbGxiYWNrczoge1xuICAgIGFzeW5jIHNlc3Npb24oeyBzZXNzaW9uLCB0b2tlbiB9KSB7XG4gICAgICBpZiAodG9rZW4gJiYgc2Vzc2lvbi51c2VyKSB7XG4gICAgICAgIChzZXNzaW9uLnVzZXIgYXMgYW55KS5pZCA9IHRva2VuLmlkIGFzIHN0cmluZztcbiAgICAgICAgKHNlc3Npb24udXNlciBhcyBhbnkpLm5hbWUgPSB0b2tlbi5uYW1lIGFzIHN0cmluZztcbiAgICAgICAgKHNlc3Npb24udXNlciBhcyBhbnkpLmVtYWlsID0gdG9rZW4uZW1haWwgYXMgc3RyaW5nO1xuICAgICAgICAoc2Vzc2lvbi51c2VyIGFzIGFueSkucm9sZSA9IHRva2VuLnJvbGUgYXMgVXNlclJvbGU7XG4gICAgICAgIChzZXNzaW9uLnVzZXIgYXMgYW55KS5hdmF0YXIgPSB0b2tlbi5hdmF0YXIgYXMgc3RyaW5nO1xuICAgICAgICAoc2Vzc2lvbi51c2VyIGFzIGFueSkuc2Vzc2lvblRva2VuID0gdG9rZW4uc2Vzc2lvblRva2VuIGFzIHN0cmluZztcbiAgICAgIH1cbiAgICAgIHJldHVybiBzZXNzaW9uO1xuICAgIH0sXG4gICAgYXN5bmMgand0KHsgdG9rZW4sIHVzZXIgfSkge1xuICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgdG9rZW4uaWQgPSB1c2VyLmlkO1xuICAgICAgICB0b2tlbi5uYW1lID0gdXNlci5uYW1lO1xuICAgICAgICB0b2tlbi5lbWFpbCA9IHVzZXIuZW1haWw7XG4gICAgICAgIHRva2VuLnJvbGUgPSB1c2VyLnJvbGU7XG4gICAgICAgIHRva2VuLmF2YXRhciA9IHVzZXIuYXZhdGFyO1xuICAgICAgICB0b2tlbi5zZXNzaW9uVG9rZW4gPSAodXNlciBhcyBhbnkpLnNlc3Npb25Ub2tlbjtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0b2tlbjtcbiAgICB9LFxuICB9LFxuICBldmVudHM6IHtcbiAgICBhc3luYyBzaWduT3V0KHsgdG9rZW4gfSkge1xuICAgICAgLy8gTG9nIGxvZ291dCBldmVudFxuICAgICAgaWYgKHRva2VuPy5pZCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGF3YWl0IGF1ZGl0U2VydmljZS5jcmVhdGVBdWRpdExvZyh7XG4gICAgICAgICAgICB1c2VySWQ6IHRva2VuLmlkIGFzIHN0cmluZyxcbiAgICAgICAgICAgIGFjdGlvblR5cGU6ICdMT0dPVVQnLFxuICAgICAgICAgICAgZW50aXR5VHlwZTogJ1VTRVInLFxuICAgICAgICAgICAgZW50aXR5SWQ6IHRva2VuLmlkIGFzIHN0cmluZyxcbiAgICAgICAgICAgIGNoYW5nZVN1bW1hcnk6ICdVc2VyIGxvZ2dlZCBvdXQnLFxuICAgICAgICAgICAgc2Vzc2lvbklkOiB0b2tlbi5zZXNzaW9uVG9rZW4gYXMgc3RyaW5nLFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIE1hcmsgZGV2aWNlIHNlc3Npb24gYXMgaW5hY3RpdmVcbiAgICAgICAgICBpZiAodG9rZW4uc2Vzc2lvblRva2VuKSB7XG4gICAgICAgICAgICBhd2FpdCBwcmlzbWEuZGV2aWNlU2Vzc2lvbi51cGRhdGVNYW55KHtcbiAgICAgICAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICAgICAgICB0b2tlbjogdG9rZW4uc2Vzc2lvblRva2VuIGFzIHN0cmluZyxcbiAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICAgIGlzQ3VycmVudDogZmFsc2UsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgbG9nZ2luZyBzaWduT3V0OicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gIH0sXG59O1xuIl0sIm5hbWVzIjpbIkNyZWRlbnRpYWxzUHJvdmlkZXIiLCJwcmlzbWEiLCJjb21wYXJlIiwiTUFYX0xPR0lOX0FUVEVNUFRTIiwiTE9DS09VVF9USU1FX01TIiwidXNlclNlcnZpY2UiLCJhdWRpdFNlcnZpY2UiLCJjcnlwdG8iLCJsb2dpbkF0dGVtcHRzIiwiYXV0aE9wdGlvbnMiLCJzZWNyZXQiLCJwcm9jZXNzIiwiZW52IiwiTkVYVEFVVEhfU0VDUkVUIiwic2Vzc2lvbiIsInN0cmF0ZWd5IiwibWF4QWdlIiwidXBkYXRlQWdlIiwicGFnZXMiLCJzaWduSW4iLCJwcm92aWRlcnMiLCJuYW1lIiwiY3JlZGVudGlhbHMiLCJlbWFpbCIsImxhYmVsIiwidHlwZSIsInBhc3N3b3JkIiwiYXV0aG9yaXplIiwidG9Mb3dlckNhc2UiLCJhdHRlbXB0IiwibG9ja1VudGlsIiwiRGF0ZSIsIm5vdyIsIkVycm9yIiwiTWF0aCIsImNlaWwiLCJ1c2VyIiwiZmluZFVuaXF1ZSIsIndoZXJlIiwic3RhdHVzIiwibG9ja2VkVW50aWwiLCJ0b0xvY2FsZVN0cmluZyIsInVwZGF0ZSIsImlkIiwiZGF0YSIsImZhaWxlZExvZ2luQXR0ZW1wdHMiLCJpc1Bhc3N3b3JkVmFsaWQiLCJmYWlsZWRBdHRlbXB0cyIsImluY3JlbWVudEZhaWxlZExvZ2lucyIsImxvY2tVc2VyIiwiY3JlYXRlQXVkaXRMb2ciLCJ1c2VySWQiLCJhY3Rpb25UeXBlIiwiZW50aXR5VHlwZSIsImVudGl0eUlkIiwiY2hhbmdlU3VtbWFyeSIsImlwQWRkcmVzcyIsInVwZGF0ZUxhc3RMb2dpbiIsInNlc3Npb25Ub2tlbiIsInJhbmRvbUJ5dGVzIiwidG9TdHJpbmciLCJleHBpcmVzQXQiLCJkZXZpY2VTZXNzaW9uIiwiY3JlYXRlIiwiZGV2aWNlIiwiaXAiLCJ0b2tlbiIsImlzQ3VycmVudCIsInNlc3Npb25JZCIsInJvbGUiLCJhdmF0YXIiLCJpbWFnZSIsImVycm9yIiwibWVzc2FnZSIsImluY2x1ZGVzIiwiY29uc29sZSIsIndhcm4iLCJjYWxsYmFja3MiLCJqd3QiLCJldmVudHMiLCJzaWduT3V0IiwidXBkYXRlTWFueSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/auth.ts\n");

/***/ }),

/***/ "(rsc)/./lib/constants.ts":
/*!**************************!*\
  !*** ./lib/constants.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   APP_NAME: () => (/* binding */ APP_NAME),\n/* harmony export */   DATE_WARNING_THRESHOLD_DAYS: () => (/* binding */ DATE_WARNING_THRESHOLD_DAYS),\n/* harmony export */   DEFAULT_ROLE_PERMISSIONS: () => (/* binding */ DEFAULT_ROLE_PERMISSIONS),\n/* harmony export */   IDLE_TIMEOUT_MS: () => (/* binding */ IDLE_TIMEOUT_MS),\n/* harmony export */   LOCKOUT_TIME_MS: () => (/* binding */ LOCKOUT_TIME_MS),\n/* harmony export */   MAX_LOGIN_ATTEMPTS: () => (/* binding */ MAX_LOGIN_ATTEMPTS),\n/* harmony export */   MOCK_DESCRIPTIONS_LEFT: () => (/* binding */ MOCK_DESCRIPTIONS_LEFT),\n/* harmony export */   MOCK_DESCRIPTIONS_RIGHT: () => (/* binding */ MOCK_DESCRIPTIONS_RIGHT),\n/* harmony export */   MOCK_USERS: () => (/* binding */ MOCK_USERS),\n/* harmony export */   ROLE_ADJUSTMENT_LIMITS: () => (/* binding */ ROLE_ADJUSTMENT_LIMITS),\n/* harmony export */   STORAGE_KEY: () => (/* binding */ STORAGE_KEY),\n/* harmony export */   WRITE_OFF_LIMIT: () => (/* binding */ WRITE_OFF_LIMIT)\n/* harmony export */ });\n/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./types */ \"(rsc)/./lib/types.ts\");\n\nconst APP_NAME = \"Analyzer Web\";\nconst MOCK_DESCRIPTIONS_LEFT = [\n    \"INV-2023-001 Supply Co\",\n    \"Payment Received - Client A\",\n    \"Service Fee - Oct\",\n    \"Transfer to Savings\",\n    \"Consulting Services\",\n    \"Software Subscription\",\n    \"Office Rent\",\n    \"Utility Bill - Power\",\n    \"Refund #9921\",\n    \"Direct Deposit - Payroll\"\n];\nconst MOCK_DESCRIPTIONS_RIGHT = [\n    \"ACH Credit: Supply Company\",\n    \"Deposit: Client A Ref 992\",\n    \"Bank Fee\",\n    \"Internal Trf 20223\",\n    \"Incoming Wire: Consulting\",\n    \"Recurring Debit: SaaS\",\n    \"Check #402 Rent\",\n    \"DD: Utility Corp\",\n    \"Refund Processed\",\n    \"Payroll Batch #221\"\n];\nconst WRITE_OFF_LIMIT = 0.50; // Allow matching with differences up to $0.50 (Auto-approve)\n// Security Constants\nconst IDLE_TIMEOUT_MS = 15 * 60 * 1000; // 15 minutes\nconst MAX_LOGIN_ATTEMPTS = 5;\nconst LOCKOUT_TIME_MS = 15 * 60 * 1000; // 15 minutes\nconst DATE_WARNING_THRESHOLD_DAYS = 10;\n// Updated storage key to force reset for new features\nconst STORAGE_KEY = \"analyzerWeb_v3_sec\";\nconst ROLE_ADJUSTMENT_LIMITS = {\n    [_types__WEBPACK_IMPORTED_MODULE_0__.UserRole.Admin]: Infinity,\n    [_types__WEBPACK_IMPORTED_MODULE_0__.UserRole.Manager]: 500.00,\n    [_types__WEBPACK_IMPORTED_MODULE_0__.UserRole.Analyst]: 10.00,\n    [_types__WEBPACK_IMPORTED_MODULE_0__.UserRole.Auditor]: 0.00\n};\nconst DEFAULT_ROLE_PERMISSIONS = {\n    [_types__WEBPACK_IMPORTED_MODULE_0__.UserRole.Admin]: [\n        \"manage_users\",\n        \"view_admin_panel\",\n        \"unmatch_transactions\",\n        \"view_all_logs\",\n        \"export_data\",\n        \"perform_matching\",\n        \"manage_periods\",\n        \"approve_adjustments\"\n    ],\n    [_types__WEBPACK_IMPORTED_MODULE_0__.UserRole.Manager]: [\n        \"unmatch_transactions\",\n        \"view_all_logs\",\n        \"export_data\",\n        \"perform_matching\",\n        \"approve_adjustments\"\n    ],\n    [_types__WEBPACK_IMPORTED_MODULE_0__.UserRole.Analyst]: [\n        \"export_data\",\n        \"perform_matching\"\n    ],\n    [_types__WEBPACK_IMPORTED_MODULE_0__.UserRole.Auditor]: [\n        \"view_all_logs\",\n        \"export_data\"\n    ]\n};\nconst MOCK_USERS = [\n    {\n        id: \"u0\",\n        name: \"System Admin\",\n        role: _types__WEBPACK_IMPORTED_MODULE_0__.UserRole.Admin,\n        avatar: \"AD\",\n        email: \"admin@reconcilepro.com\",\n        status: \"active\"\n    },\n    {\n        id: \"u1\",\n        name: \"Sarah Manager\",\n        role: _types__WEBPACK_IMPORTED_MODULE_0__.UserRole.Manager,\n        avatar: \"SM\",\n        email: \"sarah@reconcilepro.com\",\n        status: \"active\"\n    },\n    {\n        id: \"u2\",\n        name: \"John Analyst\",\n        role: _types__WEBPACK_IMPORTED_MODULE_0__.UserRole.Analyst,\n        avatar: \"JA\",\n        email: \"john@reconcilepro.com\",\n        status: \"active\"\n    },\n    {\n        id: \"u3\",\n        name: \"Mike Intern\",\n        role: _types__WEBPACK_IMPORTED_MODULE_0__.UserRole.Analyst,\n        avatar: \"MI\",\n        email: \"mike@reconcilepro.com\",\n        status: \"inactive\"\n    }\n];\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvY29uc3RhbnRzLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBMEQ7QUFFbkQsTUFBTUMsV0FBVyxlQUFlO0FBRWhDLE1BQU1DLHlCQUF5QjtJQUNwQztJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtDQUNELENBQUM7QUFFSyxNQUFNQywwQkFBMEI7SUFDckM7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7Q0FDRCxDQUFDO0FBRUssTUFBTUMsa0JBQWtCLEtBQUssQ0FBQyw2REFBNkQ7QUFFbEcscUJBQXFCO0FBQ2QsTUFBTUMsa0JBQWtCLEtBQUssS0FBSyxLQUFLLENBQUMsYUFBYTtBQUNyRCxNQUFNQyxxQkFBcUIsRUFBRTtBQUM3QixNQUFNQyxrQkFBa0IsS0FBSyxLQUFLLEtBQUssQ0FBQyxhQUFhO0FBRXJELE1BQU1DLDhCQUE4QixHQUFHO0FBRTlDLHNEQUFzRDtBQUMvQyxNQUFNQyxjQUFjLHFCQUFxQjtBQUV6QyxNQUFNQyx5QkFBbUQ7SUFDOUQsQ0FBQ1YsNENBQVFBLENBQUNXLEtBQUssQ0FBQyxFQUFFQztJQUNsQixDQUFDWiw0Q0FBUUEsQ0FBQ2EsT0FBTyxDQUFDLEVBQUU7SUFDcEIsQ0FBQ2IsNENBQVFBLENBQUNjLE9BQU8sQ0FBQyxFQUFFO0lBQ3BCLENBQUNkLDRDQUFRQSxDQUFDZSxPQUFPLENBQUMsRUFBRTtBQUN0QixFQUFFO0FBRUssTUFBTUMsMkJBQTRDO0lBQ3ZELENBQUNoQiw0Q0FBUUEsQ0FBQ1csS0FBSyxDQUFDLEVBQUU7UUFDaEI7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtLQUNEO0lBQ0QsQ0FBQ1gsNENBQVFBLENBQUNhLE9BQU8sQ0FBQyxFQUFFO1FBQ2xCO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDRDtJQUNELENBQUNiLDRDQUFRQSxDQUFDYyxPQUFPLENBQUMsRUFBRTtRQUNsQjtRQUNBO0tBQ0Q7SUFDRCxDQUFDZCw0Q0FBUUEsQ0FBQ2UsT0FBTyxDQUFDLEVBQUU7UUFDbEI7UUFDQTtLQUNEO0FBQ0gsRUFBRTtBQUVLLE1BQU1FLGFBQXFCO0lBQ2hDO1FBQUVDLElBQUk7UUFBTUMsTUFBTTtRQUFnQkMsTUFBTXBCLDRDQUFRQSxDQUFDVyxLQUFLO1FBQUVVLFFBQVE7UUFBTUMsT0FBTztRQUEwQkMsUUFBUTtJQUFTO0lBQ3hIO1FBQUVMLElBQUk7UUFBTUMsTUFBTTtRQUFpQkMsTUFBTXBCLDRDQUFRQSxDQUFDYSxPQUFPO1FBQUVRLFFBQVE7UUFBTUMsT0FBTztRQUEwQkMsUUFBUTtJQUFTO0lBQzNIO1FBQUVMLElBQUk7UUFBTUMsTUFBTTtRQUFnQkMsTUFBTXBCLDRDQUFRQSxDQUFDYyxPQUFPO1FBQUVPLFFBQVE7UUFBTUMsT0FBTztRQUF5QkMsUUFBUTtJQUFTO0lBQ3pIO1FBQUVMLElBQUk7UUFBTUMsTUFBTTtRQUFlQyxNQUFNcEIsNENBQVFBLENBQUNjLE9BQU87UUFBRU8sUUFBUTtRQUFNQyxPQUFPO1FBQXlCQyxRQUFRO0lBQVc7Q0FDM0gsQ0FBQyIsInNvdXJjZXMiOlsid2VicGFjazovL2FuYWx5emVyLXdlYi8uL2xpYi9jb25zdGFudHMudHM/MDc4ZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBVc2VyLCBVc2VyUm9sZSwgUm9sZVBlcm1pc3Npb25zIH0gZnJvbSBcIi4vdHlwZXNcIjtcblxuZXhwb3J0IGNvbnN0IEFQUF9OQU1FID0gXCJBbmFseXplciBXZWJcIjtcblxuZXhwb3J0IGNvbnN0IE1PQ0tfREVTQ1JJUFRJT05TX0xFRlQgPSBbXG4gIFwiSU5WLTIwMjMtMDAxIFN1cHBseSBDb1wiLFxuICBcIlBheW1lbnQgUmVjZWl2ZWQgLSBDbGllbnQgQVwiLFxuICBcIlNlcnZpY2UgRmVlIC0gT2N0XCIsXG4gIFwiVHJhbnNmZXIgdG8gU2F2aW5nc1wiLFxuICBcIkNvbnN1bHRpbmcgU2VydmljZXNcIixcbiAgXCJTb2Z0d2FyZSBTdWJzY3JpcHRpb25cIixcbiAgXCJPZmZpY2UgUmVudFwiLFxuICBcIlV0aWxpdHkgQmlsbCAtIFBvd2VyXCIsXG4gIFwiUmVmdW5kICM5OTIxXCIsXG4gIFwiRGlyZWN0IERlcG9zaXQgLSBQYXlyb2xsXCJcbl07XG5cbmV4cG9ydCBjb25zdCBNT0NLX0RFU0NSSVBUSU9OU19SSUdIVCA9IFtcbiAgXCJBQ0ggQ3JlZGl0OiBTdXBwbHkgQ29tcGFueVwiLFxuICBcIkRlcG9zaXQ6IENsaWVudCBBIFJlZiA5OTJcIixcbiAgXCJCYW5rIEZlZVwiLFxuICBcIkludGVybmFsIFRyZiAyMDIyM1wiLFxuICBcIkluY29taW5nIFdpcmU6IENvbnN1bHRpbmdcIixcbiAgXCJSZWN1cnJpbmcgRGViaXQ6IFNhYVNcIixcbiAgXCJDaGVjayAjNDAyIFJlbnRcIixcbiAgXCJERDogVXRpbGl0eSBDb3JwXCIsXG4gIFwiUmVmdW5kIFByb2Nlc3NlZFwiLFxuICBcIlBheXJvbGwgQmF0Y2ggIzIyMVwiXG5dO1xuXG5leHBvcnQgY29uc3QgV1JJVEVfT0ZGX0xJTUlUID0gMC41MDsgLy8gQWxsb3cgbWF0Y2hpbmcgd2l0aCBkaWZmZXJlbmNlcyB1cCB0byAkMC41MCAoQXV0by1hcHByb3ZlKVxuXG4vLyBTZWN1cml0eSBDb25zdGFudHNcbmV4cG9ydCBjb25zdCBJRExFX1RJTUVPVVRfTVMgPSAxNSAqIDYwICogMTAwMDsgLy8gMTUgbWludXRlc1xuZXhwb3J0IGNvbnN0IE1BWF9MT0dJTl9BVFRFTVBUUyA9IDU7XG5leHBvcnQgY29uc3QgTE9DS09VVF9USU1FX01TID0gMTUgKiA2MCAqIDEwMDA7IC8vIDE1IG1pbnV0ZXNcblxuZXhwb3J0IGNvbnN0IERBVEVfV0FSTklOR19USFJFU0hPTERfREFZUyA9IDEwO1xuXG4vLyBVcGRhdGVkIHN0b3JhZ2Uga2V5IHRvIGZvcmNlIHJlc2V0IGZvciBuZXcgZmVhdHVyZXNcbmV4cG9ydCBjb25zdCBTVE9SQUdFX0tFWSA9ICdhbmFseXplcldlYl92M19zZWMnO1xuXG5leHBvcnQgY29uc3QgUk9MRV9BREpVU1RNRU5UX0xJTUlUUzogUmVjb3JkPFVzZXJSb2xlLCBudW1iZXI+ID0ge1xuICBbVXNlclJvbGUuQWRtaW5dOiBJbmZpbml0eSxcbiAgW1VzZXJSb2xlLk1hbmFnZXJdOiA1MDAuMDAsXG4gIFtVc2VyUm9sZS5BbmFseXN0XTogMTAuMDAsXG4gIFtVc2VyUm9sZS5BdWRpdG9yXTogMC4wMFxufTtcblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfUk9MRV9QRVJNSVNTSU9OUzogUm9sZVBlcm1pc3Npb25zID0ge1xuICBbVXNlclJvbGUuQWRtaW5dOiBbXG4gICAgJ21hbmFnZV91c2VycycsIFxuICAgICd2aWV3X2FkbWluX3BhbmVsJywgXG4gICAgJ3VubWF0Y2hfdHJhbnNhY3Rpb25zJywgXG4gICAgJ3ZpZXdfYWxsX2xvZ3MnLCBcbiAgICAnZXhwb3J0X2RhdGEnLCBcbiAgICAncGVyZm9ybV9tYXRjaGluZycsIFxuICAgICdtYW5hZ2VfcGVyaW9kcycsXG4gICAgJ2FwcHJvdmVfYWRqdXN0bWVudHMnXG4gIF0sXG4gIFtVc2VyUm9sZS5NYW5hZ2VyXTogW1xuICAgICd1bm1hdGNoX3RyYW5zYWN0aW9ucycsIFxuICAgICd2aWV3X2FsbF9sb2dzJywgXG4gICAgJ2V4cG9ydF9kYXRhJywgXG4gICAgJ3BlcmZvcm1fbWF0Y2hpbmcnLFxuICAgICdhcHByb3ZlX2FkanVzdG1lbnRzJ1xuICBdLFxuICBbVXNlclJvbGUuQW5hbHlzdF06IFtcbiAgICAnZXhwb3J0X2RhdGEnLCBcbiAgICAncGVyZm9ybV9tYXRjaGluZydcbiAgXSxcbiAgW1VzZXJSb2xlLkF1ZGl0b3JdOiBbXG4gICAgJ3ZpZXdfYWxsX2xvZ3MnLFxuICAgICdleHBvcnRfZGF0YSdcbiAgXVxufTtcblxuZXhwb3J0IGNvbnN0IE1PQ0tfVVNFUlM6IFVzZXJbXSA9IFtcbiAgeyBpZDogJ3UwJywgbmFtZTogJ1N5c3RlbSBBZG1pbicsIHJvbGU6IFVzZXJSb2xlLkFkbWluLCBhdmF0YXI6ICdBRCcsIGVtYWlsOiAnYWRtaW5AcmVjb25jaWxlcHJvLmNvbScsIHN0YXR1czogJ2FjdGl2ZScgfSxcbiAgeyBpZDogJ3UxJywgbmFtZTogJ1NhcmFoIE1hbmFnZXInLCByb2xlOiBVc2VyUm9sZS5NYW5hZ2VyLCBhdmF0YXI6ICdTTScsIGVtYWlsOiAnc2FyYWhAcmVjb25jaWxlcHJvLmNvbScsIHN0YXR1czogJ2FjdGl2ZScgfSxcbiAgeyBpZDogJ3UyJywgbmFtZTogJ0pvaG4gQW5hbHlzdCcsIHJvbGU6IFVzZXJSb2xlLkFuYWx5c3QsIGF2YXRhcjogJ0pBJywgZW1haWw6ICdqb2huQHJlY29uY2lsZXByby5jb20nLCBzdGF0dXM6ICdhY3RpdmUnIH0sXG4gIHsgaWQ6ICd1MycsIG5hbWU6ICdNaWtlIEludGVybicsIHJvbGU6IFVzZXJSb2xlLkFuYWx5c3QsIGF2YXRhcjogJ01JJywgZW1haWw6ICdtaWtlQHJlY29uY2lsZXByby5jb20nLCBzdGF0dXM6ICdpbmFjdGl2ZScgfSxcbl07Il0sIm5hbWVzIjpbIlVzZXJSb2xlIiwiQVBQX05BTUUiLCJNT0NLX0RFU0NSSVBUSU9OU19MRUZUIiwiTU9DS19ERVNDUklQVElPTlNfUklHSFQiLCJXUklURV9PRkZfTElNSVQiLCJJRExFX1RJTUVPVVRfTVMiLCJNQVhfTE9HSU5fQVRURU1QVFMiLCJMT0NLT1VUX1RJTUVfTVMiLCJEQVRFX1dBUk5JTkdfVEhSRVNIT0xEX0RBWVMiLCJTVE9SQUdFX0tFWSIsIlJPTEVfQURKVVNUTUVOVF9MSU1JVFMiLCJBZG1pbiIsIkluZmluaXR5IiwiTWFuYWdlciIsIkFuYWx5c3QiLCJBdWRpdG9yIiwiREVGQVVMVF9ST0xFX1BFUk1JU1NJT05TIiwiTU9DS19VU0VSUyIsImlkIiwibmFtZSIsInJvbGUiLCJhdmF0YXIiLCJlbWFpbCIsInN0YXR1cyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/constants.ts\n");

/***/ }),

/***/ "(rsc)/./lib/prisma.ts":
/*!***********************!*\
  !*** ./lib/prisma.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma || new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log: [\n        \"query\"\n    ]\n});\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvcHJpc21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE4QztBQUU5QyxNQUFNQyxrQkFBa0JDO0FBRWpCLE1BQU1DLFNBQ1hGLGdCQUFnQkUsTUFBTSxJQUN0QixJQUFJSCx3REFBWUEsQ0FBQztJQUNmSSxLQUFLO1FBQUM7S0FBUTtBQUNoQixHQUFHO0FBRUwsSUFBSUMsSUFBeUIsRUFBY0osZ0JBQWdCRSxNQUFNLEdBQUdBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYW5hbHl6ZXItd2ViLy4vbGliL3ByaXNtYS50cz85ODIyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50JztcblxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHsgcHJpc21hOiBQcmlzbWFDbGllbnQgfTtcblxuZXhwb3J0IGNvbnN0IHByaXNtYSA9XG4gIGdsb2JhbEZvclByaXNtYS5wcmlzbWEgfHxcbiAgbmV3IFByaXNtYUNsaWVudCh7XG4gICAgbG9nOiBbJ3F1ZXJ5J10sXG4gIH0pO1xuXG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICdwcm9kdWN0aW9uJykgZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA9IHByaXNtYTsiXSwibmFtZXMiOlsiUHJpc21hQ2xpZW50IiwiZ2xvYmFsRm9yUHJpc21hIiwiZ2xvYmFsVGhpcyIsInByaXNtYSIsImxvZyIsInByb2Nlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/prisma.ts\n");

/***/ }),

/***/ "(rsc)/./lib/types.ts":
/*!**********************!*\
  !*** ./lib/types.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   Side: () => (/* binding */ Side),\n/* harmony export */   TransactionStatus: () => (/* binding */ TransactionStatus),\n/* harmony export */   UserRole: () => (/* binding */ UserRole)\n/* harmony export */ });\nvar Side;\n(function(Side) {\n    Side[\"Left\"] = \"LEFT\";\n    Side[\"Right\"] = \"RIGHT\";\n})(Side || (Side = {}));\nvar TransactionStatus;\n(function(TransactionStatus) {\n    TransactionStatus[\"Unmatched\"] = \"UNMATCHED\";\n    TransactionStatus[\"Matched\"] = \"MATCHED\";\n})(TransactionStatus || (TransactionStatus = {}));\nvar UserRole;\n(function(UserRole) {\n    UserRole[\"Admin\"] = \"ADMIN\";\n    UserRole[\"Manager\"] = \"MANAGER\";\n    UserRole[\"Analyst\"] = \"ANALYST\";\n    UserRole[\"Auditor\"] = \"AUDITOR\";\n})(UserRole || (UserRole = {}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9saWIvdHlwZXMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztVQUNZQTs7O0dBQUFBLFNBQUFBOztVQUtBQzs7O0dBQUFBLHNCQUFBQTs7VUFLQUM7Ozs7O0dBQUFBLGFBQUFBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYW5hbHl6ZXItd2ViLy4vbGliL3R5cGVzLnRzPzJhNTUiXSwic291cmNlc0NvbnRlbnQiOlsiXG5leHBvcnQgZW51bSBTaWRlIHtcbiAgTGVmdCA9ICdMRUZUJyxcbiAgUmlnaHQgPSAnUklHSFQnXG59XG5cbmV4cG9ydCBlbnVtIFRyYW5zYWN0aW9uU3RhdHVzIHtcbiAgVW5tYXRjaGVkID0gJ1VOTUFUQ0hFRCcsXG4gIE1hdGNoZWQgPSAnTUFUQ0hFRCdcbn1cblxuZXhwb3J0IGVudW0gVXNlclJvbGUge1xuICBBZG1pbiA9ICdBRE1JTicsXG4gIE1hbmFnZXIgPSAnTUFOQUdFUicsXG4gIEFuYWx5c3QgPSAnQU5BTFlTVCcsXG4gIEF1ZGl0b3IgPSAnQVVESVRPUidcbn1cblxuZXhwb3J0IHR5cGUgUGVybWlzc2lvbiA9IFxuICB8ICdtYW5hZ2VfdXNlcnMnIFxuICB8ICd2aWV3X2FkbWluX3BhbmVsJ1xuICB8ICd1bm1hdGNoX3RyYW5zYWN0aW9ucydcbiAgfCAndmlld19hbGxfbG9ncydcbiAgfCAnZXhwb3J0X2RhdGEnXG4gIHwgJ3BlcmZvcm1fbWF0Y2hpbmcnXG4gIHwgJ21hbmFnZV9wZXJpb2RzJ1xuICB8ICdhcHByb3ZlX2FkanVzdG1lbnRzJztcblxuZXhwb3J0IHR5cGUgUm9sZVBlcm1pc3Npb25zID0gUmVjb3JkPFVzZXJSb2xlLCBQZXJtaXNzaW9uW10+O1xuXG5leHBvcnQgaW50ZXJmYWNlIFVzZXIge1xuICBpZDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIHJvbGU6IFVzZXJSb2xlO1xuICBhdmF0YXI/OiBzdHJpbmc7XG4gIGVtYWlsPzogc3RyaW5nO1xuICBzdGF0dXM/OiAnYWN0aXZlJyB8ICdpbmFjdGl2ZScgfCAnbG9ja2VkJztcbiAgbGFzdExvZ2luPzogbnVtYmVyO1xuICBmYWlsZWRMb2dpbkF0dGVtcHRzPzogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFRyYW5zYWN0aW9uIHtcbiAgaWQ6IHN0cmluZztcbiAgZGF0ZTogc3RyaW5nO1xuICBkZXNjcmlwdGlvbjogc3RyaW5nO1xuICBhbW91bnQ6IG51bWJlcjtcbiAgcmVmZXJlbmNlOiBzdHJpbmc7XG4gIHNpZGU6IFNpZGU7XG4gIHN0YXR1czogVHJhbnNhY3Rpb25TdGF0dXM7XG4gIG1hdGNoSWQ/OiBzdHJpbmc7XG4gIGltcG9ydGVkQnk/OiBzdHJpbmc7IC8vIEZvciBTZXBhcmF0aW9uIG9mIER1dGllc1xufVxuXG5leHBvcnQgdHlwZSBNYXRjaFN0YXR1cyA9ICdBUFBST1ZFRCcgfCAnUEVORElOR19BUFBST1ZBTCc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgTWF0Y2hHcm91cCB7XG4gIGlkOiBzdHJpbmc7XG4gIHRpbWVzdGFtcDogbnVtYmVyO1xuICBsZWZ0VHJhbnNhY3Rpb25zOiBUcmFuc2FjdGlvbltdO1xuICByaWdodFRyYW5zYWN0aW9uczogVHJhbnNhY3Rpb25bXTtcbiAgdG90YWxMZWZ0OiBudW1iZXI7XG4gIHRvdGFsUmlnaHQ6IG51bWJlcjtcbiAgZGlmZmVyZW5jZTogbnVtYmVyO1xuICBhZGp1c3RtZW50PzogbnVtYmVyO1xuICBjb21tZW50Pzogc3RyaW5nO1xuICBtYXRjaEJ5VXNlcklkPzogc3RyaW5nO1xuICBzdGF0dXM6IE1hdGNoU3RhdHVzO1xuICBhcHByb3ZlZEJ5Pzogc3RyaW5nO1xuICBhcHByb3ZlZEF0PzogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIERhaWx5U3VtbWFyeSB7XG4gIGRhdGU6IHN0cmluZztcbiAgdG90YWxVbm1hdGNoZWRDb3VudDogbnVtYmVyO1xuICB0b3RhbFVubWF0Y2hlZFZhbHVlOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXVkaXRMb2dFbnRyeSB7XG4gIGlkOiBzdHJpbmc7XG4gIHRpbWVzdGFtcDogbnVtYmVyO1xuICBhY3Rpb246IHN0cmluZztcbiAgZGV0YWlsczogc3RyaW5nO1xuICB1c2VySWQ6IHN0cmluZztcbiAgdXNlck5hbWU6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBGaWx0ZXJTdGF0ZSB7XG4gIHRleHQ6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTeXN0ZW1TbmFwc2hvdCB7XG4gIGlkOiBzdHJpbmc7XG4gIHRpbWVzdGFtcDogbnVtYmVyO1xuICBsYWJlbDogc3RyaW5nO1xuICB0eXBlOiAnSU1QT1JUJyB8ICdNQU5VQUwnIHwgJ0FVVE8nO1xuICB0cmFuc2FjdGlvbnM6IFRyYW5zYWN0aW9uW107XG4gIG1hdGNoZXM6IE1hdGNoR3JvdXBbXTtcbiAgc2VsZWN0ZWREYXRlOiBzdHJpbmc7XG4gIGNyZWF0ZWRCeVVzZXJJZDogc3RyaW5nO1xuICBzdGF0czoge1xuICAgIHRvdGFsVHJhbnNhY3Rpb25zOiBudW1iZXI7XG4gICAgdG90YWxNYXRjaGVzOiBudW1iZXI7XG4gICAgbWF0Y2hlZFZhbHVlOiBudW1iZXI7XG4gIH07XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUm9sZVJlcXVlc3Qge1xuICBpZDogc3RyaW5nO1xuICB1c2VySWQ6IHN0cmluZztcbiAgdXNlck5hbWU6IHN0cmluZztcbiAgcmVxdWVzdGVkUm9sZTogVXNlclJvbGU7XG4gIHJlYXNvbjogc3RyaW5nO1xuICBzdGF0dXM6ICdQRU5ESU5HJyB8ICdBUFBST1ZFRCcgfCAnUkVKRUNURUQnO1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEZXZpY2VTZXNzaW9uIHtcbiAgaWQ6IHN0cmluZztcbiAgdXNlcklkOiBzdHJpbmc7XG4gIGRldmljZTogc3RyaW5nO1xuICBpcDogc3RyaW5nO1xuICBsYXN0QWN0aXZlOiBudW1iZXI7XG4gIGxvY2F0aW9uOiBzdHJpbmc7XG4gIGlzQ3VycmVudDogYm9vbGVhbjtcbn1cbiJdLCJuYW1lcyI6WyJTaWRlIiwiVHJhbnNhY3Rpb25TdGF0dXMiLCJVc2VyUm9sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/types.ts\n");

/***/ }),

/***/ "(rsc)/./services/AuditService.ts":
/*!**********************************!*\
  !*** ./services/AuditService.ts ***!
  \**********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AuditService: () => (/* binding */ AuditService),\n/* harmony export */   auditService: () => (/* binding */ auditService)\n/* harmony export */ });\n/* harmony import */ var _BaseService__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BaseService */ \"(rsc)/./services/BaseService.ts\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_1__);\n// Audit Service - Handles all audit logging operations\n\n\nclass AuditService extends _BaseService__WEBPACK_IMPORTED_MODULE_0__.BaseService {\n    /**\n   * Create a new audit log entry with chain verification\n   */ async createAuditLog(input) {\n        try {\n            // Get the last audit log entry for chain verification\n            const lastLog = await this.prisma.auditLog.findFirst({\n                orderBy: {\n                    timestamp: \"desc\"\n                },\n                select: {\n                    currentHash: true\n                }\n            });\n            // Calculate hashes for tamper detection\n            const previousHash = lastLog?.currentHash || null;\n            const currentHash = this.calculateHash(input, previousHash);\n            const auditLog = await this.prisma.auditLog.create({\n                data: {\n                    userId: input.userId,\n                    sessionId: input.sessionId,\n                    ipAddress: input.ipAddress,\n                    deviceFingerprint: input.deviceFingerprint,\n                    geolocation: input.geolocation,\n                    actionType: input.actionType,\n                    entityType: input.entityType,\n                    entityId: input.entityId,\n                    beforeState: input.beforeState ? JSON.stringify(input.beforeState) : null,\n                    afterState: input.afterState ? JSON.stringify(input.afterState) : null,\n                    changeSummary: input.changeSummary,\n                    justification: input.justification,\n                    previousHash,\n                    currentHash\n                }\n            });\n            return auditLog;\n        } catch (error) {\n            this.handleError(error, \"AuditService.createAuditLog\");\n        }\n    }\n    /**\n   * Get audit logs with optional filtering\n   */ async getAuditLogs(filter = {}) {\n        try {\n            const where = {};\n            if (filter.userId) {\n                where.userId = filter.userId;\n            }\n            if (filter.actionType) {\n                where.actionType = filter.actionType;\n            }\n            if (filter.entityType) {\n                where.entityType = filter.entityType;\n            }\n            if (filter.startDate || filter.endDate) {\n                where.timestamp = {};\n                if (filter.startDate) {\n                    where.timestamp.gte = filter.startDate;\n                }\n                if (filter.endDate) {\n                    where.timestamp.lte = filter.endDate;\n                }\n            }\n            return await this.prisma.auditLog.findMany({\n                where,\n                orderBy: {\n                    timestamp: \"desc\"\n                },\n                take: filter.limit || 100,\n                include: {\n                    user: {\n                        select: {\n                            id: true,\n                            name: true,\n                            email: true,\n                            role: true\n                        }\n                    }\n                }\n            });\n        } catch (error) {\n            this.handleError(error, \"AuditService.getAuditLogs\");\n        }\n    }\n    /**\n   * Get audit trail for a specific entity\n   */ async getEntityAuditTrail(entityType, entityId) {\n        try {\n            return await this.prisma.auditLog.findMany({\n                where: {\n                    entityType,\n                    entityId\n                },\n                orderBy: {\n                    timestamp: \"asc\"\n                },\n                include: {\n                    user: {\n                        select: {\n                            id: true,\n                            name: true,\n                            email: true\n                        }\n                    }\n                }\n            });\n        } catch (error) {\n            this.handleError(error, \"AuditService.getEntityAuditTrail\");\n        }\n    }\n    /**\n   * Verify the integrity of audit log chain\n   */ async verifyAuditChain() {\n        try {\n            const logs = await this.prisma.auditLog.findMany({\n                orderBy: {\n                    timestamp: \"asc\"\n                }\n            });\n            const errors = [];\n            for(let i = 1; i < logs.length; i++){\n                const currentLog = logs[i];\n                const previousLog = logs[i - 1];\n                // Check if previous hash matches\n                if (currentLog.previousHash !== previousLog.currentHash) {\n                    errors.push(`Chain broken at log ${currentLog.id}: ` + `expected previous hash ${previousLog.currentHash}, ` + `got ${currentLog.previousHash}`);\n                }\n                // Recalculate and verify current hash\n                const expectedHash = this.calculateHash({\n                    userId: currentLog.userId,\n                    actionType: currentLog.actionType,\n                    entityType: currentLog.entityType,\n                    entityId: currentLog.entityId || undefined,\n                    changeSummary: currentLog.changeSummary\n                }, currentLog.previousHash);\n                if (currentLog.currentHash !== expectedHash) {\n                    errors.push(`Hash mismatch at log ${currentLog.id}: ` + `expected ${expectedHash}, got ${currentLog.currentHash}`);\n                }\n            }\n            return {\n                valid: errors.length === 0,\n                errors\n            };\n        } catch (error) {\n            this.handleError(error, \"AuditService.verifyAuditChain\");\n        }\n    }\n    /**\n   * Calculate hash for tamper detection\n   */ calculateHash(input, previousHash) {\n        const data = JSON.stringify({\n            userId: input.userId,\n            actionType: input.actionType,\n            entityType: input.entityType,\n            entityId: input.entityId,\n            changeSummary: input.changeSummary,\n            previousHash,\n            timestamp: Date.now()\n        });\n        return crypto__WEBPACK_IMPORTED_MODULE_1___default().createHash(\"sha256\").update(data).digest(\"hex\");\n    }\n    /**\n   * Get user activity summary\n   */ async getUserActivitySummary(userId, startDate, endDate) {\n        try {\n            const logs = await this.prisma.auditLog.findMany({\n                where: {\n                    userId,\n                    timestamp: {\n                        gte: startDate,\n                        lte: endDate\n                    }\n                },\n                orderBy: {\n                    timestamp: \"desc\"\n                }\n            });\n            const actionsByType = {};\n            logs.forEach((log)=>{\n                actionsByType[log.actionType] = (actionsByType[log.actionType] || 0) + 1;\n            });\n            return {\n                totalActions: logs.length,\n                actionsByType,\n                recentActions: logs.slice(0, 10)\n            };\n        } catch (error) {\n            this.handleError(error, \"AuditService.getUserActivitySummary\");\n        }\n    }\n}\n// Export singleton instance\nconst auditService = new AuditService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bUIsU0FBZSxFQUNmQyxPQUFhLEVBS1o7UUFDRCxJQUFJO1lBQ0YsTUFBTWMsT0FBTyxNQUFNLElBQUksQ0FBQzdDLE1BQU0sQ0FBQ0MsUUFBUSxDQUFDaUMsUUFBUSxDQUFDO2dCQUMvQ0wsT0FBTztvQkFDTGxCO29CQUNBUCxXQUFXO3dCQUNUNEIsS0FBS0Y7d0JBQ0xHLEtBQUtGO29CQUNQO2dCQUNGO2dCQUNBNUIsU0FBUztvQkFBRUMsV0FBVztnQkFBTztZQUMvQjtZQUVBLE1BQU15RCxnQkFBd0MsQ0FBQztZQUMvQ2hCLEtBQUtpQixPQUFPLENBQUNDLENBQUFBO2dCQUNYRixhQUFhLENBQUNFLElBQUkvQyxVQUFVLENBQUMsR0FBRyxDQUFDNkMsYUFBYSxDQUFDRSxJQUFJL0MsVUFBVSxDQUFDLElBQUksS0FBSztZQUN6RTtZQUVBLE9BQU87Z0JBQ0xnRCxjQUFjbkIsS0FBS0csTUFBTTtnQkFDekJhO2dCQUNBSSxlQUFlcEIsS0FBS3FCLEtBQUssQ0FBQyxHQUFHO1lBQy9CO1FBQ0YsRUFBRSxPQUFPekMsT0FBTztZQUNkLElBQUksQ0FBQ0MsV0FBVyxDQUFDRCxPQUFPO1FBQzFCO0lBQ0Y7QUFDRjtBQUVBLDRCQUE0QjtBQUNyQixNQUFNMEMsZUFBZSxJQUFJdkUsZUFBZSIsInNvdXJjZXMiOlsid2VicGFjazovL2FuYWx5emVyLXdlYi8uL3NlcnZpY2VzL0F1ZGl0U2VydmljZS50cz83OTU4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIEF1ZGl0IFNlcnZpY2UgLSBIYW5kbGVzIGFsbCBhdWRpdCBsb2dnaW5nIG9wZXJhdGlvbnNcbmltcG9ydCB7IEJhc2VTZXJ2aWNlIH0gZnJvbSAnLi9CYXNlU2VydmljZSc7XG5pbXBvcnQgeyBQcmlzbWEgfSBmcm9tICdAcHJpc21hL2NsaWVudCc7XG5pbXBvcnQgY3J5cHRvIGZyb20gJ2NyeXB0byc7XG5cbi8vIFR5cGUgZGVmaW5pdGlvbiBmb3IgQXVkaXRMb2cgZW50aXR5XG50eXBlIEF1ZGl0TG9nID0gUHJpc21hLkF1ZGl0TG9nR2V0UGF5bG9hZDx7fT47XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ3JlYXRlQXVkaXRMb2dJbnB1dCB7XG4gIHVzZXJJZDogc3RyaW5nO1xuICBzZXNzaW9uSWQ/OiBzdHJpbmc7XG4gIGlwQWRkcmVzcz86IHN0cmluZztcbiAgZGV2aWNlRmluZ2VycHJpbnQ/OiBzdHJpbmc7XG4gIGdlb2xvY2F0aW9uPzogc3RyaW5nO1xuICBhY3Rpb25UeXBlOiBzdHJpbmc7IC8vIENSRUFURSwgVVBEQVRFLCBERUxFVEUsIEFQUFJPVkUsIElNUE9SVCwgRVhQT1JULCBMT0dJTiwgTE9HT1VULCBNQVRDSCwgVU5NQVRDSFxuICBlbnRpdHlUeXBlOiBzdHJpbmc7IC8vIFRSQU5TQUNUSU9OLCBNQVRDSCwgVVNFUiwgUk9MRSwgUEVSSU9ELCBTTkFQU0hPVCwgRklMRV9JTVBPUlRcbiAgZW50aXR5SWQ/OiBzdHJpbmc7XG4gIGJlZm9yZVN0YXRlPzogYW55O1xuICBhZnRlclN0YXRlPzogYW55O1xuICBjaGFuZ2VTdW1tYXJ5OiBzdHJpbmc7XG4gIGp1c3RpZmljYXRpb24/OiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQXVkaXRMb2dGaWx0ZXIge1xuICB1c2VySWQ/OiBzdHJpbmc7XG4gIGFjdGlvblR5cGU/OiBzdHJpbmc7XG4gIGVudGl0eVR5cGU/OiBzdHJpbmc7XG4gIHN0YXJ0RGF0ZT86IERhdGU7XG4gIGVuZERhdGU/OiBEYXRlO1xuICBsaW1pdD86IG51bWJlcjtcbn1cblxuZXhwb3J0IGNsYXNzIEF1ZGl0U2VydmljZSBleHRlbmRzIEJhc2VTZXJ2aWNlIHtcbiAgLyoqXG4gICAqIENyZWF0ZSBhIG5ldyBhdWRpdCBsb2cgZW50cnkgd2l0aCBjaGFpbiB2ZXJpZmljYXRpb25cbiAgICovXG4gIGFzeW5jIGNyZWF0ZUF1ZGl0TG9nKGlucHV0OiBDcmVhdGVBdWRpdExvZ0lucHV0KTogUHJvbWlzZTxBdWRpdExvZz4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBHZXQgdGhlIGxhc3QgYXVkaXQgbG9nIGVudHJ5IGZvciBjaGFpbiB2ZXJpZmljYXRpb25cbiAgICAgIGNvbnN0IGxhc3RMb2cgPSBhd2FpdCB0aGlzLnByaXNtYS5hdWRpdExvZy5maW5kRmlyc3Qoe1xuICAgICAgICBvcmRlckJ5OiB7IHRpbWVzdGFtcDogJ2Rlc2MnIH0sXG4gICAgICAgIHNlbGVjdDogeyBjdXJyZW50SGFzaDogdHJ1ZSB9LFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIENhbGN1bGF0ZSBoYXNoZXMgZm9yIHRhbXBlciBkZXRlY3Rpb25cbiAgICAgIGNvbnN0IHByZXZpb3VzSGFzaCA9IGxhc3RMb2c/LmN1cnJlbnRIYXNoIHx8IG51bGw7XG4gICAgICBjb25zdCBjdXJyZW50SGFzaCA9IHRoaXMuY2FsY3VsYXRlSGFzaChpbnB1dCwgcHJldmlvdXNIYXNoKTtcbiAgICAgIFxuICAgICAgY29uc3QgYXVkaXRMb2cgPSBhd2FpdCB0aGlzLnByaXNtYS5hdWRpdExvZy5jcmVhdGUoe1xuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgdXNlcklkOiBpbnB1dC51c2VySWQsXG4gICAgICAgICAgc2Vzc2lvbklkOiBpbnB1dC5zZXNzaW9uSWQsXG4gICAgICAgICAgaXBBZGRyZXNzOiBpbnB1dC5pcEFkZHJlc3MsXG4gICAgICAgICAgZGV2aWNlRmluZ2VycHJpbnQ6IGlucHV0LmRldmljZUZpbmdlcnByaW50LFxuICAgICAgICAgIGdlb2xvY2F0aW9uOiBpbnB1dC5nZW9sb2NhdGlvbixcbiAgICAgICAgICBhY3Rpb25UeXBlOiBpbnB1dC5hY3Rpb25UeXBlLFxuICAgICAgICAgIGVudGl0eVR5cGU6IGlucHV0LmVudGl0eVR5cGUsXG4gICAgICAgICAgZW50aXR5SWQ6IGlucHV0LmVudGl0eUlkLFxuICAgICAgICAgIGJlZm9yZVN0YXRlOiBpbnB1dC5iZWZvcmVTdGF0ZSA/IEpTT04uc3RyaW5naWZ5KGlucHV0LmJlZm9yZVN0YXRlKSA6IG51bGwsXG4gICAgICAgICAgYWZ0ZXJTdGF0ZTogaW5wdXQuYWZ0ZXJTdGF0ZSA/IEpTT04uc3RyaW5naWZ5KGlucHV0LmFmdGVyU3RhdGUpIDogbnVsbCxcbiAgICAgICAgICBjaGFuZ2VTdW1tYXJ5OiBpbnB1dC5jaGFuZ2VTdW1tYXJ5LFxuICAgICAgICAgIGp1c3RpZmljYXRpb246IGlucHV0Lmp1c3RpZmljYXRpb24sXG4gICAgICAgICAgcHJldmlvdXNIYXNoLFxuICAgICAgICAgIGN1cnJlbnRIYXNoLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIHJldHVybiBhdWRpdExvZztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgJ0F1ZGl0U2VydmljZS5jcmVhdGVBdWRpdExvZycpO1xuICAgIH1cbiAgfVxuICBcbiAgLyoqXG4gICAqIEdldCBhdWRpdCBsb2dzIHdpdGggb3B0aW9uYWwgZmlsdGVyaW5nXG4gICAqL1xuICBhc3luYyBnZXRBdWRpdExvZ3MoZmlsdGVyOiBBdWRpdExvZ0ZpbHRlciA9IHt9KTogUHJvbWlzZTxBdWRpdExvZ1tdPiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHdoZXJlOiBhbnkgPSB7fTtcbiAgICAgIFxuICAgICAgaWYgKGZpbHRlci51c2VySWQpIHtcbiAgICAgICAgd2hlcmUudXNlcklkID0gZmlsdGVyLnVzZXJJZDtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGZpbHRlci5hY3Rpb25UeXBlKSB7XG4gICAgICAgIHdoZXJlLmFjdGlvblR5cGUgPSBmaWx0ZXIuYWN0aW9uVHlwZTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGZpbHRlci5lbnRpdHlUeXBlKSB7XG4gICAgICAgIHdoZXJlLmVudGl0eVR5cGUgPSBmaWx0ZXIuZW50aXR5VHlwZTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGZpbHRlci5zdGFydERhdGUgfHwgZmlsdGVyLmVuZERhdGUpIHtcbiAgICAgICAgd2hlcmUudGltZXN0YW1wID0ge307XG4gICAgICAgIGlmIChmaWx0ZXIuc3RhcnREYXRlKSB7XG4gICAgICAgICAgd2hlcmUudGltZXN0YW1wLmd0ZSA9IGZpbHRlci5zdGFydERhdGU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZpbHRlci5lbmREYXRlKSB7XG4gICAgICAgICAgd2hlcmUudGltZXN0YW1wLmx0ZSA9IGZpbHRlci5lbmREYXRlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLnByaXNtYS5hdWRpdExvZy5maW5kTWFueSh7XG4gICAgICAgIHdoZXJlLFxuICAgICAgICBvcmRlckJ5OiB7IHRpbWVzdGFtcDogJ2Rlc2MnIH0sXG4gICAgICAgIHRha2U6IGZpbHRlci5saW1pdCB8fCAxMDAsXG4gICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgIG5hbWU6IHRydWUsXG4gICAgICAgICAgICAgIGVtYWlsOiB0cnVlLFxuICAgICAgICAgICAgICByb2xlOiB0cnVlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsICdBdWRpdFNlcnZpY2UuZ2V0QXVkaXRMb2dzJyk7XG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICogR2V0IGF1ZGl0IHRyYWlsIGZvciBhIHNwZWNpZmljIGVudGl0eVxuICAgKi9cbiAgYXN5bmMgZ2V0RW50aXR5QXVkaXRUcmFpbChcbiAgICBlbnRpdHlUeXBlOiBzdHJpbmcsXG4gICAgZW50aXR5SWQ6IHN0cmluZ1xuICApOiBQcm9taXNlPEF1ZGl0TG9nW10+IHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucHJpc21hLmF1ZGl0TG9nLmZpbmRNYW55KHtcbiAgICAgICAgd2hlcmU6IHtcbiAgICAgICAgICBlbnRpdHlUeXBlLFxuICAgICAgICAgIGVudGl0eUlkLFxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7IHRpbWVzdGFtcDogJ2FzYycgfSxcbiAgICAgICAgaW5jbHVkZToge1xuICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICAgICAgbmFtZTogdHJ1ZSxcbiAgICAgICAgICAgICAgZW1haWw6IHRydWUsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgJ0F1ZGl0U2VydmljZS5nZXRFbnRpdHlBdWRpdFRyYWlsJyk7XG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICogVmVyaWZ5IHRoZSBpbnRlZ3JpdHkgb2YgYXVkaXQgbG9nIGNoYWluXG4gICAqL1xuICBhc3luYyB2ZXJpZnlBdWRpdENoYWluKCk6IFByb21pc2U8eyB2YWxpZDogYm9vbGVhbjsgZXJyb3JzOiBzdHJpbmdbXSB9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGxvZ3MgPSBhd2FpdCB0aGlzLnByaXNtYS5hdWRpdExvZy5maW5kTWFueSh7XG4gICAgICAgIG9yZGVyQnk6IHsgdGltZXN0YW1wOiAnYXNjJyB9LFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcbiAgICAgIFxuICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBsb2dzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRMb2cgPSBsb2dzW2ldO1xuICAgICAgICBjb25zdCBwcmV2aW91c0xvZyA9IGxvZ3NbaSAtIDFdO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgaWYgcHJldmlvdXMgaGFzaCBtYXRjaGVzXG4gICAgICAgIGlmIChjdXJyZW50TG9nLnByZXZpb3VzSGFzaCAhPT0gcHJldmlvdXNMb2cuY3VycmVudEhhc2gpIHtcbiAgICAgICAgICBlcnJvcnMucHVzaChcbiAgICAgICAgICAgIGBDaGFpbiBicm9rZW4gYXQgbG9nICR7Y3VycmVudExvZy5pZH06IGAgK1xuICAgICAgICAgICAgYGV4cGVjdGVkIHByZXZpb3VzIGhhc2ggJHtwcmV2aW91c0xvZy5jdXJyZW50SGFzaH0sIGAgK1xuICAgICAgICAgICAgYGdvdCAke2N1cnJlbnRMb2cucHJldmlvdXNIYXNofWBcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBSZWNhbGN1bGF0ZSBhbmQgdmVyaWZ5IGN1cnJlbnQgaGFzaFxuICAgICAgICBjb25zdCBleHBlY3RlZEhhc2ggPSB0aGlzLmNhbGN1bGF0ZUhhc2goXG4gICAgICAgICAge1xuICAgICAgICAgICAgdXNlcklkOiBjdXJyZW50TG9nLnVzZXJJZCxcbiAgICAgICAgICAgIGFjdGlvblR5cGU6IGN1cnJlbnRMb2cuYWN0aW9uVHlwZSxcbiAgICAgICAgICAgIGVudGl0eVR5cGU6IGN1cnJlbnRMb2cuZW50aXR5VHlwZSxcbiAgICAgICAgICAgIGVudGl0eUlkOiBjdXJyZW50TG9nLmVudGl0eUlkIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIGNoYW5nZVN1bW1hcnk6IGN1cnJlbnRMb2cuY2hhbmdlU3VtbWFyeSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGN1cnJlbnRMb2cucHJldmlvdXNIYXNoXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICBpZiAoY3VycmVudExvZy5jdXJyZW50SGFzaCAhPT0gZXhwZWN0ZWRIYXNoKSB7XG4gICAgICAgICAgZXJyb3JzLnB1c2goXG4gICAgICAgICAgICBgSGFzaCBtaXNtYXRjaCBhdCBsb2cgJHtjdXJyZW50TG9nLmlkfTogYCArXG4gICAgICAgICAgICBgZXhwZWN0ZWQgJHtleHBlY3RlZEhhc2h9LCBnb3QgJHtjdXJyZW50TG9nLmN1cnJlbnRIYXNofWBcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgICBlcnJvcnMsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCAnQXVkaXRTZXJ2aWNlLnZlcmlmeUF1ZGl0Q2hhaW4nKTtcbiAgICB9XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBDYWxjdWxhdGUgaGFzaCBmb3IgdGFtcGVyIGRldGVjdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBjYWxjdWxhdGVIYXNoKGlucHV0OiBhbnksIHByZXZpb3VzSGFzaDogc3RyaW5nIHwgbnVsbCk6IHN0cmluZyB7XG4gICAgY29uc3QgZGF0YSA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIHVzZXJJZDogaW5wdXQudXNlcklkLFxuICAgICAgYWN0aW9uVHlwZTogaW5wdXQuYWN0aW9uVHlwZSxcbiAgICAgIGVudGl0eVR5cGU6IGlucHV0LmVudGl0eVR5cGUsXG4gICAgICBlbnRpdHlJZDogaW5wdXQuZW50aXR5SWQsXG4gICAgICBjaGFuZ2VTdW1tYXJ5OiBpbnB1dC5jaGFuZ2VTdW1tYXJ5LFxuICAgICAgcHJldmlvdXNIYXNoLFxuICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgIH0pO1xuICAgIFxuICAgIHJldHVybiBjcnlwdG8uY3JlYXRlSGFzaCgnc2hhMjU2JykudXBkYXRlKGRhdGEpLmRpZ2VzdCgnaGV4Jyk7XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBHZXQgdXNlciBhY3Rpdml0eSBzdW1tYXJ5XG4gICAqL1xuICBhc3luYyBnZXRVc2VyQWN0aXZpdHlTdW1tYXJ5KFxuICAgIHVzZXJJZDogc3RyaW5nLFxuICAgIHN0YXJ0RGF0ZTogRGF0ZSxcbiAgICBlbmREYXRlOiBEYXRlXG4gICk6IFByb21pc2U8e1xuICAgIHRvdGFsQWN0aW9uczogbnVtYmVyO1xuICAgIGFjdGlvbnNCeVR5cGU6IFJlY29yZDxzdHJpbmcsIG51bWJlcj47XG4gICAgcmVjZW50QWN0aW9uczogQXVkaXRMb2dbXTtcbiAgfT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBsb2dzID0gYXdhaXQgdGhpcy5wcmlzbWEuYXVkaXRMb2cuZmluZE1hbnkoe1xuICAgICAgICB3aGVyZToge1xuICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICB0aW1lc3RhbXA6IHtcbiAgICAgICAgICAgIGd0ZTogc3RhcnREYXRlLFxuICAgICAgICAgICAgbHRlOiBlbmREYXRlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIG9yZGVyQnk6IHsgdGltZXN0YW1wOiAnZGVzYycgfSxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBjb25zdCBhY3Rpb25zQnlUeXBlOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XG4gICAgICBsb2dzLmZvckVhY2gobG9nID0+IHtcbiAgICAgICAgYWN0aW9uc0J5VHlwZVtsb2cuYWN0aW9uVHlwZV0gPSAoYWN0aW9uc0J5VHlwZVtsb2cuYWN0aW9uVHlwZV0gfHwgMCkgKyAxO1xuICAgICAgfSk7XG4gICAgICBcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHRvdGFsQWN0aW9uczogbG9ncy5sZW5ndGgsXG4gICAgICAgIGFjdGlvbnNCeVR5cGUsXG4gICAgICAgIHJlY2VudEFjdGlvbnM6IGxvZ3Muc2xpY2UoMCwgMTApLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgJ0F1ZGl0U2VydmljZS5nZXRVc2VyQWN0aXZpdHlTdW1tYXJ5Jyk7XG4gICAgfVxuICB9XG59XG5cbi8vIEV4cG9ydCBzaW5nbGV0b24gaW5zdGFuY2VcbmV4cG9ydCBjb25zdCBhdWRpdFNlcnZpY2UgPSBuZXcgQXVkaXRTZXJ2aWNlKCk7XG4iXSwibmFtZXMiOlsiQmFzZVNlcnZpY2UiLCJjcnlwdG8iLCJBdWRpdFNlcnZpY2UiLCJjcmVhdGVBdWRpdExvZyIsImlucHV0IiwibGFzdExvZyIsInByaXNtYSIsImF1ZGl0TG9nIiwiZmluZEZpcnN0Iiwib3JkZXJCeSIsInRpbWVzdGFtcCIsInNlbGVjdCIsImN1cnJlbnRIYXNoIiwicHJldmlvdXNIYXNoIiwiY2FsY3VsYXRlSGFzaCIsImNyZWF0ZSIsImRhdGEiLCJ1c2VySWQiLCJzZXNzaW9uSWQiLCJpcEFkZHJlc3MiLCJkZXZpY2VGaW5nZXJwcmludCIsImdlb2xvY2F0aW9uIiwiYWN0aW9uVHlwZSIsImVudGl0eVR5cGUiLCJlbnRpdHlJZCIsImJlZm9yZVN0YXRlIiwiSlNPTiIsInN0cmluZ2lmeSIsImFmdGVyU3RhdGUiLCJjaGFuZ2VTdW1tYXJ5IiwianVzdGlmaWNhdGlvbiIsImVycm9yIiwiaGFuZGxlRXJyb3IiLCJnZXRBdWRpdExvZ3MiLCJmaWx0ZXIiLCJ3aGVyZSIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJndGUiLCJsdGUiLCJmaW5kTWFueSIsInRha2UiLCJsaW1pdCIsImluY2x1ZGUiLCJ1c2VyIiwiaWQiLCJuYW1lIiwiZW1haWwiLCJyb2xlIiwiZ2V0RW50aXR5QXVkaXRUcmFpbCIsInZlcmlmeUF1ZGl0Q2hhaW4iLCJsb2dzIiwiZXJyb3JzIiwiaSIsImxlbmd0aCIsImN1cnJlbnRMb2ciLCJwcmV2aW91c0xvZyIsInB1c2giLCJleHBlY3RlZEhhc2giLCJ1bmRlZmluZWQiLCJ2YWxpZCIsIkRhdGUiLCJub3ciLCJjcmVhdGVIYXNoIiwidXBkYXRlIiwiZGlnZXN0IiwiZ2V0VXNlckFjdGl2aXR5U3VtbWFyeSIsImFjdGlvbnNCeVR5cGUiLCJmb3JFYWNoIiwibG9nIiwidG90YWxBY3Rpb25zIiwicmVjZW50QWN0aW9ucyIsInNsaWNlIiwiYXVkaXRTZXJ2aWNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./services/AuditService.ts\n");

/***/ }),

/***/ "(rsc)/./services/BaseService.ts":
/*!*********************************!*\
  !*** ./services/BaseService.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BaseService: () => (/* binding */ BaseService)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./lib/prisma.ts\");\n// Base Service Class for common database operations\n\nclass BaseService {\n    async executeInTransaction(operation) {\n        return await this.prisma.$transaction(async ()=>{\n            return await operation();\n        });\n    }\n    handleError(error, context) {\n        console.error(`[${context}] Error:`, error);\n        throw new Error(`${context} failed: ${error.message || \"Unknown error\"}`);\n    }\n    constructor(){\n        this.prisma = _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zZXJ2aWNlcy9CYXNlU2VydmljZS50cyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLG9EQUFvRDtBQUNkO0FBRS9CLE1BQU1DO0lBR1gsTUFBZ0JDLHFCQUNkQyxTQUEyQixFQUNmO1FBQ1osT0FBTyxNQUFNLElBQUksQ0FBQ0gsTUFBTSxDQUFDSSxZQUFZLENBQUM7WUFDcEMsT0FBTyxNQUFNRDtRQUNmO0lBQ0Y7SUFFVUUsWUFBWUMsS0FBVSxFQUFFQyxPQUFlLEVBQVM7UUFDeERDLFFBQVFGLEtBQUssQ0FBQyxDQUFDLENBQUMsRUFBRUMsUUFBUSxRQUFRLENBQUMsRUFBRUQ7UUFDckMsTUFBTSxJQUFJRyxNQUFNLENBQUMsRUFBRUYsUUFBUSxTQUFTLEVBQUVELE1BQU1JLE9BQU8sSUFBSSxnQkFBZ0IsQ0FBQztJQUMxRTs7YUFiVVYsU0FBU0EsK0NBQU1BOztBQWMzQiIsInNvdXJjZXMiOlsid2VicGFjazovL2FuYWx5emVyLXdlYi8uL3NlcnZpY2VzL0Jhc2VTZXJ2aWNlLnRzPzgxNzMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQmFzZSBTZXJ2aWNlIENsYXNzIGZvciBjb21tb24gZGF0YWJhc2Ugb3BlcmF0aW9uc1xuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnQC9saWIvcHJpc21hJztcblxuZXhwb3J0IGNsYXNzIEJhc2VTZXJ2aWNlIHtcbiAgcHJvdGVjdGVkIHByaXNtYSA9IHByaXNtYTtcbiAgXG4gIHByb3RlY3RlZCBhc3luYyBleGVjdXRlSW5UcmFuc2FjdGlvbjxUPihcbiAgICBvcGVyYXRpb246ICgpID0+IFByb21pc2U8VD5cbiAgKTogUHJvbWlzZTxUPiB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMucHJpc21hLiR0cmFuc2FjdGlvbihhc3luYyAoKSA9PiB7XG4gICAgICByZXR1cm4gYXdhaXQgb3BlcmF0aW9uKCk7XG4gICAgfSk7XG4gIH1cbiAgXG4gIHByb3RlY3RlZCBoYW5kbGVFcnJvcihlcnJvcjogYW55LCBjb250ZXh0OiBzdHJpbmcpOiBuZXZlciB7XG4gICAgY29uc29sZS5lcnJvcihgWyR7Y29udGV4dH1dIEVycm9yOmAsIGVycm9yKTtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYCR7Y29udGV4dH0gZmFpbGVkOiAke2Vycm9yLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InfWApO1xuICB9XG59XG4iXSwibmFtZXMiOlsicHJpc21hIiwiQmFzZVNlcnZpY2UiLCJleGVjdXRlSW5UcmFuc2FjdGlvbiIsIm9wZXJhdGlvbiIsIiR0cmFuc2FjdGlvbiIsImhhbmRsZUVycm9yIiwiZXJyb3IiLCJjb250ZXh0IiwiY29uc29sZSIsIkVycm9yIiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./services/BaseService.ts\n");

/***/ }),

/***/ "(rsc)/./services/UserService.ts":
/*!*********************************!*\
  !*** ./services/UserService.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   UserService: () => (/* binding */ UserService),\n/* harmony export */   userService: () => (/* binding */ userService)\n/* harmony export */ });\n/* harmony import */ var _BaseService__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./BaseService */ \"(rsc)/./services/BaseService.ts\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_1__);\n// User Service - Handles all user-related database operations\n\n\nclass UserService extends _BaseService__WEBPACK_IMPORTED_MODULE_0__.BaseService {\n    /**\n   * Create a new user with hashed password\n   */ async createUser(input) {\n        try {\n            const hashedPassword = await (0,bcryptjs__WEBPACK_IMPORTED_MODULE_1__.hash)(input.password, 12);\n            const user = await this.prisma.user.create({\n                data: {\n                    email: input.email.toLowerCase(),\n                    name: input.name,\n                    password: hashedPassword,\n                    role: input.role || \"ANALYST\",\n                    status: input.status || \"active\",\n                    avatar: input.avatar || this.generateAvatar(input.name)\n                }\n            });\n            return user;\n        } catch (error) {\n            this.handleError(error, \"UserService.createUser\");\n        }\n    }\n    /**\n   * Find user by email\n   */ async findUserByEmail(email) {\n        try {\n            return await this.prisma.user.findUnique({\n                where: {\n                    email: email.toLowerCase()\n                }\n            });\n        } catch (error) {\n            this.handleError(error, \"UserService.findUserByEmail\");\n        }\n    }\n    /**\n   * Find user by ID\n   */ async findUserById(id) {\n        try {\n            return await this.prisma.user.findUnique({\n                where: {\n                    id\n                }\n            });\n        } catch (error) {\n            this.handleError(error, \"UserService.findUserById\");\n        }\n    }\n    /**\n   * Get all users (excluding password)\n   */ async getAllUsers() {\n        try {\n            const users = await this.prisma.user.findMany({\n                select: {\n                    id: true,\n                    email: true,\n                    name: true,\n                    role: true,\n                    status: true,\n                    avatar: true,\n                    mfaEnabled: true,\n                    mfaSecret: true,\n                    lastLogin: true,\n                    failedLoginAttempts: true,\n                    lockedUntil: true,\n                    passwordChangedAt: true,\n                    createdAt: true,\n                    updatedAt: true\n                },\n                orderBy: {\n                    name: \"asc\"\n                }\n            });\n            return users;\n        } catch (error) {\n            this.handleError(error, \"UserService.getAllUsers\");\n        }\n    }\n    /**\n   * Update user details\n   */ async updateUser(id, input) {\n        try {\n            return await this.prisma.user.update({\n                where: {\n                    id\n                },\n                data: input\n            });\n        } catch (error) {\n            this.handleError(error, \"UserService.updateUser\");\n        }\n    }\n    /**\n   * Delete user\n   */ async deleteUser(id) {\n        try {\n            return await this.prisma.user.delete({\n                where: {\n                    id\n                }\n            });\n        } catch (error) {\n            this.handleError(error, \"UserService.deleteUser\");\n        }\n    }\n    /**\n   * Verify user password\n   */ async verifyPassword(user, password) {\n        try {\n            return await (0,bcryptjs__WEBPACK_IMPORTED_MODULE_1__.compare)(password, user.password);\n        } catch (error) {\n            this.handleError(error, \"UserService.verifyPassword\");\n        }\n    }\n    /**\n   * Update user's last login timestamp\n   */ async updateLastLogin(userId) {\n        try {\n            await this.prisma.user.update({\n                where: {\n                    id: userId\n                },\n                data: {\n                    lastLogin: new Date(),\n                    failedLoginAttempts: 0\n                }\n            });\n        } catch (error) {\n            this.handleError(error, \"UserService.updateLastLogin\");\n        }\n    }\n    /**\n   * Increment failed login attempts\n   */ async incrementFailedLogins(userId) {\n        try {\n            const user = await this.prisma.user.update({\n                where: {\n                    id: userId\n                },\n                data: {\n                    failedLoginAttempts: {\n                        increment: 1\n                    }\n                }\n            });\n            return user.failedLoginAttempts;\n        } catch (error) {\n            this.handleError(error, \"UserService.incrementFailedLogins\");\n        }\n    }\n    /**\n   * Lock user account\n   */ async lockUser(userId, lockUntil) {\n        try {\n            await this.prisma.user.update({\n                where: {\n                    id: userId\n                },\n                data: {\n                    status: \"locked\",\n                    lockedUntil: lockUntil\n                }\n            });\n        } catch (error) {\n            this.handleError(error, \"UserService.lockUser\");\n        }\n    }\n    /**\n   * Generate avatar initials from name\n   */ generateAvatar(name) {\n        return name.split(\" \").map((n)=>n[0]).join(\"\").substring(0, 2).toUpperCase();\n    }\n}\n// Export singleton instance\nconst userService = new UserService();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBQ0QsSUFBSSxDQUFDZ0MsTUFBTSxDQUFDO2dCQUM1QmpCLE9BQU87b0JBQUVFLElBQUlvQjtnQkFBTztnQkFDcEJsQyxNQUFNO29CQUNKSyxRQUFRO29CQUNSa0IsYUFBYWdCO2dCQUNmO1lBQ0Y7UUFDRixFQUFFLE9BQU8vQixPQUFPO1lBQ2QsSUFBSSxDQUFDQyxXQUFXLENBQUNELE9BQU87UUFDMUI7SUFDRjtJQUVBOztHQUVDLEdBQ0QsZUFBdUJMLElBQVksRUFBVTtRQUMzQyxPQUFPQSxLQUNKcUMsS0FBSyxDQUFDLEtBQ05DLEdBQUcsQ0FBQ0MsQ0FBQUEsSUFBS0EsQ0FBQyxDQUFDLEVBQUUsRUFDYkMsSUFBSSxDQUFDLElBQ0xDLFNBQVMsQ0FBQyxHQUFHLEdBQ2JDLFdBQVc7SUFDaEI7QUFDRjtBQUVBLDRCQUE0QjtBQUNyQixNQUFNQyxjQUFjLElBQUl0RCxjQUFjIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYW5hbHl6ZXItd2ViLy4vc2VydmljZXMvVXNlclNlcnZpY2UudHM/YWFkNCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBVc2VyIFNlcnZpY2UgLSBIYW5kbGVzIGFsbCB1c2VyLXJlbGF0ZWQgZGF0YWJhc2Ugb3BlcmF0aW9uc1xuaW1wb3J0IHsgQmFzZVNlcnZpY2UgfSBmcm9tICcuL0Jhc2VTZXJ2aWNlJztcbmltcG9ydCB7IFByaXNtYSB9IGZyb20gJ0BwcmlzbWEvY2xpZW50JztcbmltcG9ydCB7IGhhc2gsIGNvbXBhcmUgfSBmcm9tICdiY3J5cHRqcyc7XG5cbi8vIFR5cGUgZGVmaW5pdGlvbnMgZm9yIFVzZXIgZW50aXR5XG50eXBlIFVzZXIgPSBQcmlzbWEuVXNlckdldFBheWxvYWQ8e30+O1xudHlwZSBVc2VyV2l0aG91dFBhc3N3b3JkID0gT21pdDxVc2VyLCAncGFzc3dvcmQnPjtcblxuZXhwb3J0IGludGVyZmFjZSBDcmVhdGVVc2VySW5wdXQge1xuICBlbWFpbDogc3RyaW5nO1xuICBuYW1lOiBzdHJpbmc7XG4gIHBhc3N3b3JkOiBzdHJpbmc7XG4gIHJvbGU/OiBzdHJpbmc7XG4gIHN0YXR1cz86IHN0cmluZztcbiAgYXZhdGFyPzogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFVwZGF0ZVVzZXJJbnB1dCB7XG4gIG5hbWU/OiBzdHJpbmc7XG4gIGVtYWlsPzogc3RyaW5nO1xuICByb2xlPzogc3RyaW5nO1xuICBzdGF0dXM/OiBzdHJpbmc7XG4gIGF2YXRhcj86IHN0cmluZztcbn1cblxuZXhwb3J0IGNsYXNzIFVzZXJTZXJ2aWNlIGV4dGVuZHMgQmFzZVNlcnZpY2Uge1xuICAvKipcbiAgICogQ3JlYXRlIGEgbmV3IHVzZXIgd2l0aCBoYXNoZWQgcGFzc3dvcmRcbiAgICovXG4gIGFzeW5jIGNyZWF0ZVVzZXIoaW5wdXQ6IENyZWF0ZVVzZXJJbnB1dCk6IFByb21pc2U8VXNlcj4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBoYXNoZWRQYXNzd29yZCA9IGF3YWl0IGhhc2goaW5wdXQucGFzc3dvcmQsIDEyKTtcbiAgICAgIFxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHRoaXMucHJpc21hLnVzZXIuY3JlYXRlKHtcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIGVtYWlsOiBpbnB1dC5lbWFpbC50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgIG5hbWU6IGlucHV0Lm5hbWUsXG4gICAgICAgICAgcGFzc3dvcmQ6IGhhc2hlZFBhc3N3b3JkLFxuICAgICAgICAgIHJvbGU6IGlucHV0LnJvbGUgfHwgJ0FOQUxZU1QnLFxuICAgICAgICAgIHN0YXR1czogaW5wdXQuc3RhdHVzIHx8ICdhY3RpdmUnLFxuICAgICAgICAgIGF2YXRhcjogaW5wdXQuYXZhdGFyIHx8IHRoaXMuZ2VuZXJhdGVBdmF0YXIoaW5wdXQubmFtZSksXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHVzZXI7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsICdVc2VyU2VydmljZS5jcmVhdGVVc2VyJyk7XG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICogRmluZCB1c2VyIGJ5IGVtYWlsXG4gICAqL1xuICBhc3luYyBmaW5kVXNlckJ5RW1haWwoZW1haWw6IHN0cmluZyk6IFByb21pc2U8VXNlciB8IG51bGw+IHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7XG4gICAgICAgIHdoZXJlOiB7IGVtYWlsOiBlbWFpbC50b0xvd2VyQ2FzZSgpIH0sXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgJ1VzZXJTZXJ2aWNlLmZpbmRVc2VyQnlFbWFpbCcpO1xuICAgIH1cbiAgfVxuICBcbiAgLyoqXG4gICAqIEZpbmQgdXNlciBieSBJRFxuICAgKi9cbiAgYXN5bmMgZmluZFVzZXJCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPFVzZXIgfCBudWxsPiB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLnByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xuICAgICAgICB3aGVyZTogeyBpZCB9LFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsICdVc2VyU2VydmljZS5maW5kVXNlckJ5SWQnKTtcbiAgICB9XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBHZXQgYWxsIHVzZXJzIChleGNsdWRpbmcgcGFzc3dvcmQpXG4gICAqL1xuICBhc3luYyBnZXRBbGxVc2VycygpOiBQcm9taXNlPFVzZXJXaXRob3V0UGFzc3dvcmRbXT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB1c2VycyA9IGF3YWl0IHRoaXMucHJpc21hLnVzZXIuZmluZE1hbnkoe1xuICAgICAgICBzZWxlY3Q6IHtcbiAgICAgICAgICBpZDogdHJ1ZSxcbiAgICAgICAgICBlbWFpbDogdHJ1ZSxcbiAgICAgICAgICBuYW1lOiB0cnVlLFxuICAgICAgICAgIHJvbGU6IHRydWUsXG4gICAgICAgICAgc3RhdHVzOiB0cnVlLFxuICAgICAgICAgIGF2YXRhcjogdHJ1ZSxcbiAgICAgICAgICBtZmFFbmFibGVkOiB0cnVlLFxuICAgICAgICAgIG1mYVNlY3JldDogdHJ1ZSxcbiAgICAgICAgICBsYXN0TG9naW46IHRydWUsXG4gICAgICAgICAgZmFpbGVkTG9naW5BdHRlbXB0czogdHJ1ZSxcbiAgICAgICAgICBsb2NrZWRVbnRpbDogdHJ1ZSxcbiAgICAgICAgICBwYXNzd29yZENoYW5nZWRBdDogdHJ1ZSxcbiAgICAgICAgICBjcmVhdGVkQXQ6IHRydWUsXG4gICAgICAgICAgdXBkYXRlZEF0OiB0cnVlLFxuICAgICAgICB9LFxuICAgICAgICBvcmRlckJ5OiB7IG5hbWU6ICdhc2MnIH0sXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgcmV0dXJuIHVzZXJzIGFzIFVzZXJXaXRob3V0UGFzc3dvcmRbXTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgJ1VzZXJTZXJ2aWNlLmdldEFsbFVzZXJzJyk7XG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICogVXBkYXRlIHVzZXIgZGV0YWlsc1xuICAgKi9cbiAgYXN5bmMgdXBkYXRlVXNlcihpZDogc3RyaW5nLCBpbnB1dDogVXBkYXRlVXNlcklucHV0KTogUHJvbWlzZTxVc2VyPiB7XG4gICAgdHJ5IHtcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLnByaXNtYS51c2VyLnVwZGF0ZSh7XG4gICAgICAgIHdoZXJlOiB7IGlkIH0sXG4gICAgICAgIGRhdGE6IGlucHV0LFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsICdVc2VyU2VydmljZS51cGRhdGVVc2VyJyk7XG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICogRGVsZXRlIHVzZXJcbiAgICovXG4gIGFzeW5jIGRlbGV0ZVVzZXIoaWQ6IHN0cmluZyk6IFByb21pc2U8VXNlcj4ge1xuICAgIHRyeSB7XG4gICAgICByZXR1cm4gYXdhaXQgdGhpcy5wcmlzbWEudXNlci5kZWxldGUoe1xuICAgICAgICB3aGVyZTogeyBpZCB9LFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsICdVc2VyU2VydmljZS5kZWxldGVVc2VyJyk7XG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICogVmVyaWZ5IHVzZXIgcGFzc3dvcmRcbiAgICovXG4gIGFzeW5jIHZlcmlmeVBhc3N3b3JkKHVzZXI6IFVzZXIsIHBhc3N3b3JkOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IGNvbXBhcmUocGFzc3dvcmQsIHVzZXIucGFzc3dvcmQpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCAnVXNlclNlcnZpY2UudmVyaWZ5UGFzc3dvcmQnKTtcbiAgICB9XG4gIH1cbiAgXG4gIC8qKlxuICAgKiBVcGRhdGUgdXNlcidzIGxhc3QgbG9naW4gdGltZXN0YW1wXG4gICAqL1xuICBhc3luYyB1cGRhdGVMYXN0TG9naW4odXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5wcmlzbWEudXNlci51cGRhdGUoe1xuICAgICAgICB3aGVyZTogeyBpZDogdXNlcklkIH0sXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICBsYXN0TG9naW46IG5ldyBEYXRlKCksXG4gICAgICAgICAgZmFpbGVkTG9naW5BdHRlbXB0czogMCxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aGlzLmhhbmRsZUVycm9yKGVycm9yLCAnVXNlclNlcnZpY2UudXBkYXRlTGFzdExvZ2luJyk7XG4gICAgfVxuICB9XG4gIFxuICAvKipcbiAgICogSW5jcmVtZW50IGZhaWxlZCBsb2dpbiBhdHRlbXB0c1xuICAgKi9cbiAgYXN5bmMgaW5jcmVtZW50RmFpbGVkTG9naW5zKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IHRoaXMucHJpc21hLnVzZXIudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHVzZXJJZCB9LFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgZmFpbGVkTG9naW5BdHRlbXB0czogeyBpbmNyZW1lbnQ6IDEgfSxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHVzZXIuZmFpbGVkTG9naW5BdHRlbXB0cztcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgdGhpcy5oYW5kbGVFcnJvcihlcnJvciwgJ1VzZXJTZXJ2aWNlLmluY3JlbWVudEZhaWxlZExvZ2lucycpO1xuICAgIH1cbiAgfVxuICBcbiAgLyoqXG4gICAqIExvY2sgdXNlciBhY2NvdW50XG4gICAqL1xuICBhc3luYyBsb2NrVXNlcih1c2VySWQ6IHN0cmluZywgbG9ja1VudGlsOiBEYXRlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IHRoaXMucHJpc21hLnVzZXIudXBkYXRlKHtcbiAgICAgICAgd2hlcmU6IHsgaWQ6IHVzZXJJZCB9LFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgc3RhdHVzOiAnbG9ja2VkJyxcbiAgICAgICAgICBsb2NrZWRVbnRpbDogbG9ja1VudGlsLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IsICdVc2VyU2VydmljZS5sb2NrVXNlcicpO1xuICAgIH1cbiAgfVxuICBcbiAgLyoqXG4gICAqIEdlbmVyYXRlIGF2YXRhciBpbml0aWFscyBmcm9tIG5hbWVcbiAgICovXG4gIHByaXZhdGUgZ2VuZXJhdGVBdmF0YXIobmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gbmFtZVxuICAgICAgLnNwbGl0KCcgJylcbiAgICAgIC5tYXAobiA9PiBuWzBdKVxuICAgICAgLmpvaW4oJycpXG4gICAgICAuc3Vic3RyaW5nKDAsIDIpXG4gICAgICAudG9VcHBlckNhc2UoKTtcbiAgfVxufVxuXG4vLyBFeHBvcnQgc2luZ2xldG9uIGluc3RhbmNlXG5leHBvcnQgY29uc3QgdXNlclNlcnZpY2UgPSBuZXcgVXNlclNlcnZpY2UoKTtcbiJdLCJuYW1lcyI6WyJCYXNlU2VydmljZSIsImhhc2giLCJjb21wYXJlIiwiVXNlclNlcnZpY2UiLCJjcmVhdGVVc2VyIiwiaW5wdXQiLCJoYXNoZWRQYXNzd29yZCIsInBhc3N3b3JkIiwidXNlciIsInByaXNtYSIsImNyZWF0ZSIsImRhdGEiLCJlbWFpbCIsInRvTG93ZXJDYXNlIiwibmFtZSIsInJvbGUiLCJzdGF0dXMiLCJhdmF0YXIiLCJnZW5lcmF0ZUF2YXRhciIsImVycm9yIiwiaGFuZGxlRXJyb3IiLCJmaW5kVXNlckJ5RW1haWwiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJmaW5kVXNlckJ5SWQiLCJpZCIsImdldEFsbFVzZXJzIiwidXNlcnMiLCJmaW5kTWFueSIsInNlbGVjdCIsIm1mYUVuYWJsZWQiLCJtZmFTZWNyZXQiLCJsYXN0TG9naW4iLCJmYWlsZWRMb2dpbkF0dGVtcHRzIiwibG9ja2VkVW50aWwiLCJwYXNzd29yZENoYW5nZWRBdCIsImNyZWF0ZWRBdCIsInVwZGF0ZWRBdCIsIm9yZGVyQnkiLCJ1cGRhdGVVc2VyIiwidXBkYXRlIiwiZGVsZXRlVXNlciIsImRlbGV0ZSIsInZlcmlmeVBhc3N3b3JkIiwidXBkYXRlTGFzdExvZ2luIiwidXNlcklkIiwiRGF0ZSIsImluY3JlbWVudEZhaWxlZExvZ2lucyIsImluY3JlbWVudCIsImxvY2tVc2VyIiwibG9ja1VudGlsIiwic3BsaXQiLCJtYXAiLCJuIiwiam9pbiIsInN1YnN0cmluZyIsInRvVXBwZXJDYXNlIiwidXNlclNlcnZpY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./services/UserService.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/next-auth","vendor-chunks/@babel","vendor-chunks/jose","vendor-chunks/openid-client","vendor-chunks/bcryptjs","vendor-chunks/oauth","vendor-chunks/object-hash","vendor-chunks/preact","vendor-chunks/preact-render-to-string","vendor-chunks/uuid","vendor-chunks/yallist","vendor-chunks/lru-cache","vendor-chunks/cookie","vendor-chunks/oidc-token-hash","vendor-chunks/@panva"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=C%3A%5Cmani%5Cise%5Cprojects%5CArbutus%5Capps%5Canalyzer-web%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5Cmani%5Cise%5Cprojects%5CArbutus%5Capps%5Canalyzer-web&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();